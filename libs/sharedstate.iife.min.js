var SHAREDSTATE=function(t){"use strict";function e(){let t;return[new Promise(((e,s)=>{t=e})),t]}const s=4;class n{constructor(t,e={}){this._url=t,this._ws,this._connecting=!1,this._connected=!1,this._options=e,this._retries=0,this._connect_promise_resolvers=[]}get connecting(){return this._connecting}get connected(){return this._connected}get url(){return this._url}get options(){return this._options}connect(){this.connecting||this.connected?console.log("Connect while connecting or connected"):this._is_terminated()?console.log("Terminated"):(this._ws=new WebSocket(this._url),this._connecting=!0,this._ws.onopen=t=>this._on_open(t),this._ws.onmessage=t=>this.on_message(t.data),this._ws.onclose=t=>this._on_close(t),this._ws.onerror=t=>this.on_error(t),this.on_connecting())}_on_open(t){this._connecting=!1,this._connected=!0;for(const t of this._connect_promise_resolvers)t();this._connect_promise_resolvers=[],this._retries=0,this.on_connect()}_on_close(t){this._connecting=!1,this._connected=!1,this.on_disconnect(t),this._retries+=1,this._is_terminated()||setTimeout((()=>{this.connect()}),1e3*this._retries)}_is_terminated(){const{retries:t=s}=this._options;return this._retries>=t&&(console.log(`Terminated: Max retries reached (${t})`),this._connecting=!1,this._connected=!0,this._ws.onopen=void 0,this._ws.onmessage=void 0,this._ws.onclose=void 0,this._ws.onerror=void 0,this._ws=void 0,!0)}on_connecting(){const{debug:t=!1}=this._options;t&&console.log(`Connecting ${this.url}`)}on_connect(){console.log(`Connect  ${this.url}`)}on_error(t){const{debug:e=!1}=this._options;e&&console.log(`Error: ${t}`)}on_disconnect(t){console.error(`Disconnect ${this.url}`)}on_message(t){const{debug:e=!1}=this._options;e&&console.log(`Receive: ${t}`)}send(t){if(this._connected)try{this._ws.send(t)}catch(t){console.error(`Send fail: ${t}`)}else console.log("Send drop : not connected")}connectedPromise(){const[t,s]=e();return this.connected?s():this._connect_promise_resolvers.push(s),t}}class i{constructor(t,e,s={}){this._options=s,this._terminated=!1,this._ssclient=t,this._path=e,this._handlers=[],this._map=new Map}_ssclient_terminate(){this._terminated=!0,this._handlers=[]}_ssclient_update(t={}){if(this._terminated)throw new Error("collection already terminated");const{remove:e,insert:s,reset:n=!1}=t,i=new Map;if(n){for(const t of this._map.values())i.set(t.id,{id:t.id,new:void 0,old:t});this._map=new Map}else for(const t of e){const e=this._map.get(t);null!=e&&(this._map.delete(t),i.set(t,{id:t,new:void 0,old:e}))}for(const t of s){const e=t.id,s=i.get(e),n=null!=s?s.old:this._map.get(e);this._map.set(e,t),i.set(e,{id:e,new:t,old:n})}this._notify_callbacks([...i.values()])}_notify_callbacks(t){this._handlers.forEach((function(e){e.handler(t)}))}get size(){return this._map.size}has(t){return this._map.has(t)}get(t){return null==t?[...this._map.values()]:this._map.get(t)}update(t={}){if(this._terminated)throw new Error("collection already terminated");const{insert:e=[]}=t;return t.insert=e.map((t=>(t.id=t.id||function(t){for(var e="",s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",n=0;n<t;n++)e+=s.charAt(Math.floor(52*Math.random()));return e}(10),t))),this._ssclient.update(this._path,t)}add_callback(t){const e={handler:t};return this._handlers.push(e),e}remove_callback(t){const e=this._handlers.indexOf(t);e>-1&&this._handlers.splice(e,1)}}class o{constructor(t,e,s={}){this._terminiated=!1,this._coll=t,this._id=e,this._options=s,this._handlers=[],this._handle=this._coll.add_callback(this._onchange.bind(this))}_onchange(t){if(this._terminated)throw new Error("proxy object terminated");for(const e of t)e.id==this._id&&this.notify_callbacks(e)}add_callback(t){const e={handler:t};return this._handlers.push(e),e}remove_callback(t){let e=this._handlers.indexOf(t);e>-1&&this._handers.splice(e,1)}notify_callbacks(t){this._handlers.forEach((function(e){e.handler(t)}))}set(t){if(this._terminated)throw new Error("proxy object terminated");const e=[{id:this._id,data:t}];return this._coll.update({insert:e,reset:!1})}get(){return this._coll.has(this._id)?this._coll.get(this._id).data:void 0}ss_client_terminate(){this._terminated=!0,this._coll.remove_callback(this._handle)}}const r=function(){return performance.now()/1e3},c=function(){return new Date/1e3},_=function(){const t=r(),e=c();return{now:function(){const s=r();return e+(s-t)}}}();class h{constructor(t){this._ssclient=t,this._pinger=new a(this._onping.bind(this)),this._samples=[],this._trans=1e3,this._skew=0}resume(){this._pinger.resume()}pause(){this._pinger.pause()}_onping(){const t=_.now();this._ssclient.get("/clock").then((({ok:e,data:s})=>{if(e){const e=_.now();this._add_sample(t,s,e)}}))}_add_sample(t,e,s){let n=(s-t)/2,i=e-(s+t)/2,o=[t,e,s,n,i];this._samples.push(o),this._samples.length>30&&this._samples.shift(),n=1e5,i=0;for(const t of this._samples)t[3]<n&&(n=t[3],i=t[4]);this._skew=i,this._trans=n}get skew(){return this._skew}get trans(){return this._trans}now(){return _.now()+this._skew}}const l=[...new Array(3).fill(20),...new Array(7).fill(500),1e4];class a{constructor(t){this._count=0,this._tid=void 0,this._callback=t,this._ping=this.ping.bind(this),this._delays=[...l]}pause(){clearTimeout(this._tid)}resume(){clearTimeout(this._tid),this.ping()}restart(){this._delays=[...l],clearTimeout(this._tid),this.ping()}ping(){let t=this._delays[0];this._delays.length>1&&this._delays.shift(),this._callback&&this._callback(),this._tid=setTimeout(this._ping,t)}}const d=Object.freeze({MESSAGE:"MESSAGE",REQUEST:"REQUEST",REPLY:"REPLY"}),u=Object.freeze({GET:"GET",PUT:"PUT",NOTIFY:"NOTIFY"});function p(t){const{id:e,itv:s,data:n}=t;let i=JSON.stringify(n);return`\n        <div>\n            <button id="delete">X</button>\n            ${`<span class="id">${e}</span>`}: ${`<span class="itv">${null!=s?JSON.stringify(s):""}</span>`} ${`<span class="data">${i}</span>`}\n        </div>`}return t.CollectionViewer=class{constructor(t,e,s={}){this._coll=t,this._elem=e,this._handle=this._coll.add_callback(this._onchange.bind(this));let n={delete:!1,toString:p};this._options={...n,...s},this._options.delete&&e.addEventListener("click",(t=>{const e=t.target.closest("#delete");if(e){const s=e.closest(".list-item");s&&(this._coll.update({remove:[s.id]}),t.stopPropagation())}}));const i=this._coll.get().map((t=>({id:t.id,new:t})));this._onchange(i)}_onchange(t){const{toString:e}=this._options;for(let s of t)if(s.new){let t=this._elem.querySelector(`#${s.id}`);null==t&&(t=document.createElement("div"),t.setAttribute("id",s.id),t.classList.add("list-item"),this._elem.appendChild(t)),t.innerHTML=e(s.new)}else if(s.old){let t=this._elem.querySelector(`#${s.id}`);t&&t.parentNode.removeChild(t)}}},t.SharedStateClient=class extends n{constructor(t,e){super(t,e),this._reqid=0,this._pending=new Map,this._subs_map=new Map,this._coll_map=new Map,this._obj_map=new Map,this._server_clock,this.connect()}on_connect(){if(console.log(`Connect  ${this.url}`),this._subs_map.size>0){const t=[...this._subs_map.entries()];this.update("/subs",{insert:t,reset:!0})}null!=this._server_clock&&this._server_clock.resume()}on_disconnect(){console.error(`Disconnect ${this.url}`),null!=this._server_clock&&this._server_clock.pause()}on_error(t){const{debug:e=!1}=this._options;e&&console.log(`Communication Error: ${t}`)}on_message(t){let e=JSON.parse(t);if(e.type==d.REPLY){let t=e.tunnel;if(this._pending.has(t)){let s=this._pending.get(t);this._pending.delete(t);const{ok:n,data:i}=e;s({ok:n,data:i})}}else e.type==d.MESSAGE&&e.cmd==u.NOTIFY&&this._handle_notify(e)}_handle_notify(t){const e=this._coll_map.get(t.path);null!=e&&e._ssclient_update(t.data)}_request(t,s,n){const i=this._reqid++,o={type:d.REQUEST,cmd:t,path:s,arg:n,tunnel:i};this.send(JSON.stringify(o));let[r,c]=e();return this._pending.set(i,c),r.then((({ok:e,data:n})=>(t==u.PUT&&"/subs"==s&&e&&(this._subs_map=new Map(n)),{ok:e,path:s,data:n})))}_sub(t){if(this.connected){new Map([...this._subs_map]).set(t,{});const e=[...this._subs_map.entries()];return this.update("/subs",{insert:e,reset:!0})}return this._subs_map.set(t,{}),Promise.resolve({ok:!0,path:t,data:void 0})}_unsub(t){const e=new Map([...this._subs_map]);e.delete(t);const s=[...e.entries()];return this.update("/subs",{insert:s,reset:!0})}get clock(){return null==this._server_clock&&(this._server_clock=new h(this),this.connected&&this._server_clock.resume()),this._server_clock}get(t){return this._request(u.GET,t)}update(t,e){return this._request(u.PUT,t,e)}acquire_collection(t,e){return t=t.startsWith("/")?t:"/"+t,this._subs_map.has(t)||this._sub(t),this._coll_map.has(t)||this._coll_map.set(t,new i(this,t,e)),this._coll_map.get(t)}acquire_object(t,e,s){t=t.startsWith("/")?t:"/"+t;const n=this.acquire_collection(t);this._obj_map.has(t)||this._obj_map.set(t,new Map);const i=this._obj_map.get(t);return i.get(e)||i.set(e,new o(n,e,s)),i.get(e)}release(t){this._subs_map.has(t)&&this._unsub(t);this._coll_map.get(t)._ssclient_terminate();const e=this._obj_map.get(t);if(null!=e)for(const t of e.values())t._ssclient_terminate();this._coll_map.delete(t),this._obj_map.delete(t)}},t}({});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2hhcmVkc3RhdGUuaWlmZS5taW4uanMiLCJzb3VyY2VzIjpbIi4uLy4uL2NsaWVudC91dGlsLmpzIiwiLi4vLi4vY2xpZW50L3dzaW8uanMiLCIuLi8uLi9jbGllbnQvc3NfY29sbGVjdGlvbi5qcyIsIi4uLy4uL2NsaWVudC9zc19vYmplY3QuanMiLCIuLi8uLi9jbGllbnQvc2VydmVyY2xvY2suanMiLCIuLi8uLi9jbGllbnQvc3NfY2xpZW50LmpzIiwiLi4vLi4vY2xpZW50L3ZpZXdlci5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKlxuICAgIENyZWF0ZSBhIHByb21pc2Ugd2hpY2ggY2FuIGJlIHJlc29sdmVkXG4gICAgcHJvZ3JhbW1hdGljYWxseSBieSBleHRlcm5hbCBjb2RlLlxuICAgIFJldHVybiBhIHByb21pc2UgYW5kIGEgcmVzb2x2ZSBmdW5jdGlvblxuKi9cblxuZXhwb3J0IGZ1bmN0aW9uIHJlc29sdmFibGVQcm9taXNlKCkge1xuICAgIGxldCByZXNvbHZlcjtcbiAgICBsZXQgcHJvbWlzZSA9IG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgcmVzb2x2ZXIgPSByZXNvbHZlO1xuICAgIH0pO1xuICAgIHJldHVybiBbcHJvbWlzZSwgcmVzb2x2ZXJdO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gdGltZW91dFByb21pc2UgKG1zKSB7XG4gICAgbGV0IHJlc29sdmVyO1xuICAgIGxldCBwcm9taXNlID0gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICBsZXQgdGlkID0gc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICByZXNvbHZlKHRydWUpO1xuICAgICAgICB9LCBtcyk7XG4gICAgICAgIHJlc29sdmVyID0gKCkgPT4ge1xuICAgICAgICAgICAgaWYgKHRpZCkge1xuICAgICAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aWQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmVzb2x2ZShmYWxzZSk7XG4gICAgICAgIH1cbiAgICB9KTtcbiAgICByZXR1cm4gW3Byb21pc2UsIHJlc29sdmVyXTtcbn1cblxuXG5leHBvcnQgZnVuY3Rpb24gcmFuZG9tX3N0cmluZyhsZW5ndGgpIHtcbiAgICB2YXIgdGV4dCA9IFwiXCI7XG4gICAgdmFyIHBvc3NpYmxlID0gXCJBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWmFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6XCI7XG4gICAgZm9yKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHRleHQgKz0gcG9zc2libGUuY2hhckF0KE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIHBvc3NpYmxlLmxlbmd0aCkpO1xuICAgIH1cbiAgICByZXR1cm4gdGV4dDtcbn0iLCJpbXBvcnQgeyByZXNvbHZhYmxlUHJvbWlzZSB9IGZyb20gXCIuL3V0aWwuanNcIjtcblxuY29uc3QgTUFYX1JFVFJJRVMgPSA0O1xuXG5leHBvcnQgY2xhc3MgV2ViU29ja2V0SU8ge1xuXG4gICAgY29uc3RydWN0b3IodXJsLCBvcHRpb25zPXt9KSB7XG4gICAgICAgIHRoaXMuX3VybCA9IHVybDtcbiAgICAgICAgdGhpcy5fd3M7XG4gICAgICAgIHRoaXMuX2Nvbm5lY3RpbmcgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5fY29ubmVjdGVkID0gZmFsc2U7XG4gICAgICAgIHRoaXMuX29wdGlvbnMgPSBvcHRpb25zO1xuICAgICAgICB0aGlzLl9yZXRyaWVzID0gMDtcbiAgICAgICAgdGhpcy5fY29ubmVjdF9wcm9taXNlX3Jlc29sdmVycyA9IFtdO1xuICAgIH1cblxuICAgIGdldCBjb25uZWN0aW5nKCkge3JldHVybiB0aGlzLl9jb25uZWN0aW5nO31cbiAgICBnZXQgY29ubmVjdGVkKCkge3JldHVybiB0aGlzLl9jb25uZWN0ZWQ7fVxuICAgIGdldCB1cmwoKSB7cmV0dXJuIHRoaXMuX3VybDt9XG4gICAgZ2V0IG9wdGlvbnMoKSB7cmV0dXJuIHRoaXMuX29wdGlvbnM7fVxuXG4gICAgY29ubmVjdCgpIHtcblxuICAgICAgICBpZiAodGhpcy5jb25uZWN0aW5nIHx8IHRoaXMuY29ubmVjdGVkKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIkNvbm5lY3Qgd2hpbGUgY29ubmVjdGluZyBvciBjb25uZWN0ZWRcIik7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuX2lzX3Rlcm1pbmF0ZWQoKSkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCJUZXJtaW5hdGVkXCIpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gY29ubmVjdGluZ1xuICAgICAgICB0aGlzLl93cyA9IG5ldyBXZWJTb2NrZXQodGhpcy5fdXJsKTtcbiAgICAgICAgdGhpcy5fY29ubmVjdGluZyA9IHRydWU7XG4gICAgICAgIHRoaXMuX3dzLm9ub3BlbiA9IGUgPT4gdGhpcy5fb25fb3BlbihlKTtcbiAgICAgICAgdGhpcy5fd3Mub25tZXNzYWdlID0gZSA9PiB0aGlzLm9uX21lc3NhZ2UoZS5kYXRhKTtcbiAgICAgICAgdGhpcy5fd3Mub25jbG9zZSA9IGUgPT4gdGhpcy5fb25fY2xvc2UoZSk7XG4gICAgICAgIHRoaXMuX3dzLm9uZXJyb3IgPSBlID0+IHRoaXMub25fZXJyb3IoZSk7XG4gICAgICAgIHRoaXMub25fY29ubmVjdGluZygpO1xuICAgIH1cblxuICAgIF9vbl9vcGVuKGV2ZW50KSB7XG4gICAgICAgIHRoaXMuX2Nvbm5lY3RpbmcgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5fY29ubmVjdGVkID0gdHJ1ZTtcbiAgICAgICAgLy8gcmVsZWFzZSBjb25uZWN0IHByb21pc2VzXG4gICAgICAgIGZvciAoY29uc3QgcmVzb2x2ZXIgb2YgdGhpcy5fY29ubmVjdF9wcm9taXNlX3Jlc29sdmVycykge1xuICAgICAgICAgICAgcmVzb2x2ZXIoKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9jb25uZWN0X3Byb21pc2VfcmVzb2x2ZXJzID0gW107XG4gICAgICAgIC8vIHJlc2V0IHJldHJpZXMgb24gc3VjY2Vzc2Z1bCBjb25uZWN0aW9uXG4gICAgICAgIHRoaXMuX3JldHJpZXMgPSAwO1xuICAgICAgICB0aGlzLm9uX2Nvbm5lY3QoKTtcbiAgICB9XG5cbiAgICBfb25fY2xvc2UoZXZlbnQpIHtcbiAgICAgICAgdGhpcy5fY29ubmVjdGluZyA9IGZhbHNlO1xuICAgICAgICB0aGlzLl9jb25uZWN0ZWQgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5vbl9kaXNjb25uZWN0KGV2ZW50KTtcbiAgICAgICAgdGhpcy5fcmV0cmllcyArPSAxO1xuICAgICAgICBpZiAoIXRoaXMuX2lzX3Rlcm1pbmF0ZWQoKSkge1xuICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5jb25uZWN0KCk7XG4gICAgICAgICAgICB9LCAxMDAwICogdGhpcy5fcmV0cmllcyk7XG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgX2lzX3Rlcm1pbmF0ZWQoKSB7XG4gICAgICAgIGNvbnN0IHtyZXRyaWVzPU1BWF9SRVRSSUVTfSA9IHRoaXMuX29wdGlvbnM7XG4gICAgICAgIGlmICh0aGlzLl9yZXRyaWVzID49IHJldHJpZXMpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGBUZXJtaW5hdGVkOiBNYXggcmV0cmllcyByZWFjaGVkICgke3JldHJpZXN9KWApO1xuICAgICAgICAgICAgdGhpcy5fY29ubmVjdGluZyA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy5fY29ubmVjdGVkID0gdHJ1ZTtcbiAgICAgICAgICAgIHRoaXMuX3dzLm9ub3BlbiA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgIHRoaXMuX3dzLm9ubWVzc2FnZSA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgIHRoaXMuX3dzLm9uY2xvc2UgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICB0aGlzLl93cy5vbmVycm9yID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgdGhpcy5fd3MgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgb25fY29ubmVjdGluZygpIHtcbiAgICAgICAgY29uc3Qge2RlYnVnPWZhbHNlfSA9IHRoaXMuX29wdGlvbnM7XG4gICAgICAgIGlmIChkZWJ1Zykge2NvbnNvbGUubG9nKGBDb25uZWN0aW5nICR7dGhpcy51cmx9YCk7fVxuICAgIH1cbiAgICBvbl9jb25uZWN0KCkge1xuICAgICAgICBjb25zb2xlLmxvZyhgQ29ubmVjdCAgJHt0aGlzLnVybH1gKTtcbiAgICB9XG4gICAgb25fZXJyb3IoZXJyb3IpIHtcbiAgICAgICAgY29uc3Qge2RlYnVnPWZhbHNlfSA9IHRoaXMuX29wdGlvbnM7XG4gICAgICAgIGlmIChkZWJ1Zykge2NvbnNvbGUubG9nKGBFcnJvcjogJHtlcnJvcn1gKTt9XG4gICAgfVxuICAgIG9uX2Rpc2Nvbm5lY3QoZXZlbnQpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcihgRGlzY29ubmVjdCAke3RoaXMudXJsfWApO1xuICAgIH1cbiAgICBvbl9tZXNzYWdlKGRhdGEpIHtcbiAgICAgICAgY29uc3Qge2RlYnVnPWZhbHNlfSA9IHRoaXMuX29wdGlvbnM7XG4gICAgICAgIGlmIChkZWJ1Zykge2NvbnNvbGUubG9nKGBSZWNlaXZlOiAke2RhdGF9YCk7fVxuICAgIH1cblxuICAgIHNlbmQoZGF0YSkge1xuICAgICAgICBpZiAodGhpcy5fY29ubmVjdGVkKSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIHRoaXMuX3dzLnNlbmQoZGF0YSk7XG4gICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYFNlbmQgZmFpbDogJHtlcnJvcn1gKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGBTZW5kIGRyb3AgOiBub3QgY29ubmVjdGVkYClcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGNvbm5lY3RlZFByb21pc2UoKSB7XG4gICAgICAgIGNvbnN0IFtwcm9taXNlLCByZXNvbHZlcl0gPSByZXNvbHZhYmxlUHJvbWlzZSgpO1xuICAgICAgICBpZiAodGhpcy5jb25uZWN0ZWQpIHtcbiAgICAgICAgICAgIHJlc29sdmVyKCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLl9jb25uZWN0X3Byb21pc2VfcmVzb2x2ZXJzLnB1c2gocmVzb2x2ZXIpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBwcm9taXNlO1xuICAgIH1cbn1cblxuXG4iLCJpbXBvcnQgeyByYW5kb21fc3RyaW5nIH0gZnJvbSBcIi4vdXRpbC5qc1wiO1xuXG5leHBvcnQgY2xhc3MgUHJveHlDb2xsZWN0aW9uIHtcblxuICAgIGNvbnN0cnVjdG9yKHNzY2xpZW50LCBwYXRoLCBvcHRpb25zPXt9KSB7XG4gICAgICAgIHRoaXMuX29wdGlvbnMgPSBvcHRpb25zO1xuICAgICAgICB0aGlzLl90ZXJtaW5hdGVkID0gZmFsc2U7XG4gICAgICAgIC8vIHNoYXJlZHN0YXRlIGNsaWVudFxuICAgICAgICB0aGlzLl9zc2NsaWVudCA9IHNzY2xpZW50O1xuICAgICAgICB0aGlzLl9wYXRoID0gcGF0aDtcbiAgICAgICAgLy8gY2FsbGJhY2tzXG4gICAgICAgIHRoaXMuX2hhbmRsZXJzID0gW107XG4gICAgICAgIC8vIGl0ZW1zXG4gICAgICAgIHRoaXMuX21hcCA9IG5ldyBNYXAoKTtcbiAgICB9XG5cbiAgICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4gICAgICAgIFNIQVJFRCBTVEFURSBDTElFTlQgQVBJXG4gICAgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cblxuICAgIC8qKlxuICAgICAqIENvbGxlY3Rpb24gcmVsZWFzZWQgYnkgc3MgY2xpZW50XG4gICAgICovXG5cbiAgICBfc3NjbGllbnRfdGVybWluYXRlKCkge1xuICAgICAgICB0aGlzLl90ZXJtaW5hdGVkID0gdHJ1ZTtcbiAgICAgICAgLy8gZW1wdHkgY29sbGVjdGlvbj9cbiAgICAgICAgLy8gZGlzY29ubmVjdCBmcm9tIG9ic2VydmVyc1xuICAgICAgICB0aGlzLl9oYW5kbGVycyA9IFtdO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIHNlcnZlciB1cGRhdGUgY29sbGVjdGlvbiBcbiAgICAgKi9cbiAgICBfc3NjbGllbnRfdXBkYXRlIChjaGFuZ2VzPXt9KSB7XG5cbiAgICAgICAgaWYgKHRoaXMuX3Rlcm1pbmF0ZWQpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcImNvbGxlY3Rpb24gYWxyZWFkeSB0ZXJtaW5hdGVkXCIpXG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCB7cmVtb3ZlLCBpbnNlcnQsIHJlc2V0PWZhbHNlfSA9IGNoYW5nZXM7XG4gICAgICAgIGNvbnN0IGRpZmZfbWFwID0gbmV3IE1hcCgpO1xuXG4gICAgICAgIC8vIHJlbW92ZSBpdGVtcyAtIGNyZWF0ZSBkaWZmXG4gICAgICAgIGlmIChyZXNldCkge1xuICAgICAgICAgICAgZm9yIChjb25zdCBpdGVtIG9mIHRoaXMuX21hcC52YWx1ZXMoKSkge1xuICAgICAgICAgICAgICAgIGRpZmZfbWFwLnNldChcbiAgICAgICAgICAgICAgICAgICAgaXRlbS5pZCwgXG4gICAgICAgICAgICAgICAgICAgIHtpZDogaXRlbS5pZCwgbmV3OnVuZGVmaW5lZCwgb2xkOml0ZW19XG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuX21hcCA9IG5ldyBNYXAoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGZvciAoY29uc3QgX2lkIG9mIHJlbW92ZSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IG9sZCA9IHRoaXMuX21hcC5nZXQoX2lkKTtcbiAgICAgICAgICAgICAgICBpZiAob2xkICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9tYXAuZGVsZXRlKF9pZCk7XG4gICAgICAgICAgICAgICAgICAgIGRpZmZfbWFwLnNldChfaWQsIHtpZDpfaWQsIG5ldzp1bmRlZmluZWQsIG9sZH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGluc2VydCBpdGVtcyAtIHVwZGF0ZSBkaWZmXG4gICAgICAgIGZvciAoY29uc3QgaXRlbSBvZiBpbnNlcnQpIHtcbiAgICAgICAgICAgIGNvbnN0IF9pZCA9IGl0ZW0uaWQ7XG4gICAgICAgICAgICAvLyBvbGQgZnJvbSBkaWZmX21hcCBvciBfbWFwXG4gICAgICAgICAgICBjb25zdCBkaWZmID0gZGlmZl9tYXAuZ2V0KF9pZCk7XG4gICAgICAgICAgICBjb25zdCBvbGQgPSAoZGlmZiAhPSB1bmRlZmluZWQpID8gZGlmZi5vbGQgOiB0aGlzLl9tYXAuZ2V0KF9pZCk7XG4gICAgICAgICAgICAvLyBzZXQgc3RhdGVcbiAgICAgICAgICAgIHRoaXMuX21hcC5zZXQoX2lkLCBpdGVtKTtcbiAgICAgICAgICAgIC8vIHVwZGF0ZSBkaWZmIG1hcFxuICAgICAgICAgICAgZGlmZl9tYXAuc2V0KF9pZCwge2lkOl9pZCwgbmV3Oml0ZW0sIG9sZH0pO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX25vdGlmeV9jYWxsYmFja3MoWy4uLmRpZmZfbWFwLnZhbHVlcygpXSk7XG4gICAgfVxuXG4gICAgX25vdGlmeV9jYWxsYmFja3MgKGVBcmcpIHtcbiAgICAgICAgdGhpcy5faGFuZGxlcnMuZm9yRWFjaChmdW5jdGlvbihoYW5kbGUpIHtcbiAgICAgICAgICAgIGhhbmRsZS5oYW5kbGVyKGVBcmcpO1xuICAgICAgICB9KTtcbiAgICB9O1xuXG4gICAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuICAgICAgICBBUFBMSUNBVElPTiBBUElcbiAgICAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuXG4gICAgZ2V0IHNpemUoKSB7cmV0dXJuIHRoaXMuX21hcC5zaXplfVxuICAgIGhhcyhpZCkge3JldHVybiB0aGlzLl9tYXAuaGFzKGlkKX1cbiAgICBnZXQoaWQpIHtcbiAgICAgICAgaWYgKGlkID09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcmV0dXJuIFsuLi50aGlzLl9tYXAudmFsdWVzKCldXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fbWFwLmdldChpZClcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIGFwcGxpY2F0aW9uIGRpc3BhdGNoaW5nIHVwZGF0ZSB0byBzZXJ2ZXJcbiAgICAgKi9cbiAgICB1cGRhdGUgKGNoYW5nZXM9e30pIHtcbiAgICAgICAgaWYgKHRoaXMuX3Rlcm1pbmF0ZWQpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcImNvbGxlY3Rpb24gYWxyZWFkeSB0ZXJtaW5hdGVkXCIpXG4gICAgICAgIH1cbiAgICAgICAgLy8gZW5zdXJlIHRoYXQgaW5zZXJ0ZWQgaXRlbXMgaGF2ZSBpZHNcbiAgICAgICAgY29uc3Qge2luc2VydD1bXX0gPSBjaGFuZ2VzO1xuICAgICAgICBjaGFuZ2VzLmluc2VydCA9IGluc2VydC5tYXAoKGl0ZW0pID0+IHtcbiAgICAgICAgICAgIGl0ZW0uaWQgPSBpdGVtLmlkIHx8IHJhbmRvbV9zdHJpbmcoMTApO1xuICAgICAgICAgICAgcmV0dXJuIGl0ZW07XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gdGhpcy5fc3NjbGllbnQudXBkYXRlKHRoaXMuX3BhdGgsIGNoYW5nZXMpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIGFwcGxpY2F0aW9uIHJlZ2lzdGVyIGNhbGxiYWNrXG4gICAgKi9cbiAgICBhZGRfY2FsbGJhY2sgKGhhbmRsZXIpIHtcbiAgICAgICAgY29uc3QgaGFuZGxlID0ge2hhbmRsZXJ9O1xuICAgICAgICB0aGlzLl9oYW5kbGVycy5wdXNoKGhhbmRsZSk7XG4gICAgICAgIHJldHVybiBoYW5kbGU7XG4gICAgfTsgICAgXG4gICAgcmVtb3ZlX2NhbGxiYWNrIChoYW5kbGUpIHtcbiAgICAgICAgY29uc3QgaW5kZXggPSB0aGlzLl9oYW5kbGVycy5pbmRleE9mKGhhbmRsZSk7XG4gICAgICAgIGlmIChpbmRleCA+IC0xKSB7XG4gICAgICAgICAgICB0aGlzLl9oYW5kbGVycy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICB9XG4gICAgfTsgICAgXG59IiwiXG4vKipcbiAqIFByb3h5IE9iamVjdFxuICogXG4gKiBDbGllbnQtc2lkZSBwcm94eSBvYmplY3QgZm9yIGEgc2VydmVyLXNpZGUgb2JqZWN0LlxuICpcbiAqIEltcGxlbWVudGF0aW9uIGxldmVyYWdlcyBQcm94eUNvbGxlY3Rpb24uIEFzIHN1Y2gsIHRoZSB2YWx1ZSBvZiB0aGUgcHJveHkgb2JqZWN0XG4gKiBjb3JyZXNwb25kcyB0byB0aGUgZGF0YSBwcm9wZXJ0eSBvZiBhIHNpbmdsZSBpdGVtIHdpdGggKmlkKiB3aXRoaW4gYSBcbiAqIHNwZWNpZmljIHNlcnZlci1zaWRlIGNvbGxlY3Rpb24uIElmIG5vIGl0ZW0gd2l0aCAqaWQqIGV4aXN0cyBpbiB0aGUgY29sbGVjdGlvbiwgdGhlXG4gKiB2YWx1ZSBvZiB0aGUgcHJveHkgb2JqZWN0IGlzIHVuZGVmaW5lZC4gXG4gKiBcbiAqIHNldCgpIGFuZCBnZXQoKSBtZXRob2RzIGFyZSB1c2VkIHRvIHNldCBhbmQgZ2V0IHRoZSB2YWx1ZSBvZiB0aGUgcHJveHkgb2JqZWN0LlxuICogXG4gKi9cblxuZXhwb3J0IGNsYXNzIFByb3h5T2JqZWN0IHtcblxuICAgIGNvbnN0cnVjdG9yKHByb3h5Q29sbGVjdGlvbiwgaWQsIG9wdGlvbnM9e30pIHtcbiAgICAgICAgdGhpcy5fdGVybWluaWF0ZWQgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5fY29sbCA9IHByb3h5Q29sbGVjdGlvbjtcbiAgICAgICAgdGhpcy5faWQgPSBpZDtcbiAgICAgICAgdGhpcy5fb3B0aW9ucyA9IG9wdGlvbnM7XG4gICAgICAgIC8vIGNhbGxiYWNrXG4gICAgICAgIHRoaXMuX2hhbmRsZXJzID0gW107XG4gICAgICAgIHRoaXMuX2hhbmRsZSA9IHRoaXMuX2NvbGwuYWRkX2NhbGxiYWNrKHRoaXMuX29uY2hhbmdlLmJpbmQodGhpcykpO1xuICAgIH1cblxuICAgIF9vbmNoYW5nZShkaWZmcykge1xuICAgICAgICBpZiAodGhpcy5fdGVybWluYXRlZCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwicHJveHkgb2JqZWN0IHRlcm1pbmF0ZWRcIilcbiAgICAgICAgfVxuICAgICAgICBmb3IgKGNvbnN0IGRpZmYgb2YgZGlmZnMpIHtcbiAgICAgICAgICAgIGlmIChkaWZmLmlkID09IHRoaXMuX2lkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5ub3RpZnlfY2FsbGJhY2tzKGRpZmYpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgYWRkX2NhbGxiYWNrIChoYW5kbGVyKSB7XG4gICAgICAgIGNvbnN0IGhhbmRsZSA9IHtoYW5kbGVyOiBoYW5kbGVyfTtcbiAgICAgICAgdGhpcy5faGFuZGxlcnMucHVzaChoYW5kbGUpO1xuICAgICAgICByZXR1cm4gaGFuZGxlO1xuICAgIH07XG4gICAgXG4gICAgcmVtb3ZlX2NhbGxiYWNrIChoYW5kbGUpIHtcbiAgICAgICAgbGV0IGluZGV4ID0gdGhpcy5faGFuZGxlcnMuaW5kZXhPZihoYW5kbGUpO1xuICAgICAgICBpZiAoaW5kZXggPiAtMSkge1xuICAgICAgICAgICAgdGhpcy5faGFuZGVycy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBcbiAgICBub3RpZnlfY2FsbGJhY2tzIChlQXJnKSB7XG4gICAgICAgIHRoaXMuX2hhbmRsZXJzLmZvckVhY2goZnVuY3Rpb24oaGFuZGxlKSB7XG4gICAgICAgICAgICBoYW5kbGUuaGFuZGxlcihlQXJnKTtcbiAgICAgICAgfSk7XG4gICAgfTtcblxuICAgIFxuICAgIHNldCAob2JqKSB7XG4gICAgICAgIGlmICh0aGlzLl90ZXJtaW5hdGVkKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJwcm94eSBvYmplY3QgdGVybWluYXRlZFwiKVxuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGl0ZW1zID0gW3tpZDp0aGlzLl9pZCwgZGF0YTpvYmp9XTtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2NvbGwudXBkYXRlKHtpbnNlcnQ6aXRlbXMsIHJlc2V0OmZhbHNlfSk7XG4gICAgfVxuXG4gICAgZ2V0ICgpIHtcbiAgICAgICAgaWYgKHRoaXMuX2NvbGwuaGFzKHRoaXMuX2lkKSkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2NvbGwuZ2V0KHRoaXMuX2lkKS5kYXRhO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgfVxuICAgIH1cbiAgICBcbiAgICBzc19jbGllbnRfdGVybWluYXRlKCkge1xuICAgICAgICB0aGlzLl90ZXJtaW5hdGVkID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5fY29sbC5yZW1vdmVfY2FsbGJhY2sodGhpcy5faGFuZGxlKTtcbiAgICB9XG59IiwiLy8gd2VicGFnZSBjbG9jayAtIHBlcmZvcm1hbmNlIG5vdyAtIHNlY29uZHNcbmNvbnN0IGxvY2FsID0ge1xuICAgIG5vdzogZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBwZXJmb3JtYW5jZS5ub3coKS8xMDAwLjA7XG4gICAgfVxufVxuLy8gc3lzdGVtIGNsb2NrIC0gZXBvY2ggLSBzZWNvbmRzXG5jb25zdCBlcG9jaCA9IHtcbiAgICBub3c6IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gbmV3IERhdGUoKS8xMDAwLjA7XG4gICAgfVxufVxuXG4vKipcbiAqIENMT0NLIGdpdmVzIGVwb2NoIHZhbHVlcywgYnV0IGlzIGltcGxlbWVudGVkXG4gKiB1c2luZyBwZXJmb3JtYW5jZSBub3cgZm9yIGJldHRlclxuICogdGltZSByZXNvbHV0aW9uIGFuZCBwcm90ZWN0aW9uIGFnYWluc3Qgc3lzdGVtIFxuICogdGltZSBhZGp1c3RtZW50cy5cbiAqL1xuXG5jb25zdCBDTE9DSyA9IGZ1bmN0aW9uICgpIHtcbiAgICBjb25zdCB0MF9sb2NhbCA9IGxvY2FsLm5vdygpO1xuICAgIGNvbnN0IHQwX2Vwb2NoID0gZXBvY2gubm93KCk7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgbm93OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBjb25zdCB0MV9sb2NhbCA9IGxvY2FsLm5vdygpO1xuICAgICAgICAgICAgcmV0dXJuIHQwX2Vwb2NoICsgKHQxX2xvY2FsIC0gdDBfbG9jYWwpO1xuICAgICAgICB9XG4gICAgfTtcbn0oKTtcblxuXG4vKipcbiAqIEVzdGltYXRlIHRoZSBjbG9jayBvZiB0aGUgc2VydmVyIFxuICovXG5cbmNvbnN0IE1BWF9TQU1QTEVfQ09VTlQgPSAzMDtcblxuZXhwb3J0IGNsYXNzIFNlcnZlckNsb2NrIHtcblxuICAgIGNvbnN0cnVjdG9yKHNzY2xpZW50KSB7XG4gICAgICAgIC8vIHNoYXJlc3RhdGUgY2xpZW50XG4gICAgICAgIHRoaXMuX3NzY2xpZW50ID0gc3NjbGllbnQ7XG4gICAgICAgIC8vIHBpbmdlclxuICAgICAgICB0aGlzLl9waW5nZXIgPSBuZXcgUGluZ2VyKHRoaXMuX29ucGluZy5iaW5kKHRoaXMpKTtcbiAgICAgICAgLy8gc2FtcGxlc1xuICAgICAgICB0aGlzLl9zYW1wbGVzID0gW107XG4gICAgICAgIC8vIGVzdGltYXRlc1xuICAgICAgICB0aGlzLl90cmFucyA9IDEwMDAuMDtcbiAgICAgICAgdGhpcy5fc2tldyA9IDAuMDtcbiAgICB9XG5cbiAgICByZXN1bWUoKSB7XG4gICAgICAgIHRoaXMuX3Bpbmdlci5yZXN1bWUoKTtcbiAgICB9XG5cbiAgICBwYXVzZSgpIHtcbiAgICAgICAgdGhpcy5fcGluZ2VyLnBhdXNlKCk7XG4gICAgfVxuXG4gICAgX29ucGluZygpIHtcbiAgICAgICAgY29uc3QgdHMwID0gQ0xPQ0subm93KCk7XG4gICAgICAgIHRoaXMuX3NzY2xpZW50LmdldChcIi9jbG9ja1wiKS50aGVuKCh7b2ssIGRhdGF9KSA9PiB7XG4gICAgICAgICAgICBpZiAob2spIHtcbiAgICAgICAgICAgICAgICBjb25zdCB0czEgPSBDTE9DSy5ub3coKTtcbiAgICAgICAgICAgICAgICB0aGlzLl9hZGRfc2FtcGxlKHRzMCwgZGF0YSwgdHMxKTsgICAgXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIF9hZGRfc2FtcGxlKGNzLCBzcywgY3IpIHtcbiAgICAgICAgbGV0IHRyYW5zID0gKGNyIC0gY3MpIC8gMi4wO1xuICAgICAgICBsZXQgc2tldyA9IHNzIC0gKGNyICsgY3MpIC8gMi4wO1xuICAgICAgICBsZXQgc2FtcGxlID0gW2NzLCBzcywgY3IsIHRyYW5zLCBza2V3XTtcbiAgICAgICAgLy8gYWRkIHRvIHNhbXBsZXNcbiAgICAgICAgdGhpcy5fc2FtcGxlcy5wdXNoKHNhbXBsZSlcbiAgICAgICAgaWYgKHRoaXMuX3NhbXBsZXMubGVuZ3RoID4gTUFYX1NBTVBMRV9DT1VOVCkge1xuICAgICAgICAgICAgLy8gcmVtb3ZlIGZpcnN0IHNhbXBsZVxuICAgICAgICAgICAgdGhpcy5fc2FtcGxlcy5zaGlmdCgpO1xuICAgICAgICB9XG4gICAgICAgIC8vIHJlZXZhbHVhdGUgZXN0aW1hdGVzIGZvciBza2V3IGFuZCB0cmFuc1xuICAgICAgICB0cmFucyA9IDEwMDAwMC4wO1xuICAgICAgICBza2V3ID0gMC4wO1xuICAgICAgICBmb3IgKGNvbnN0IHNhbXBsZSBvZiB0aGlzLl9zYW1wbGVzKSB7XG4gICAgICAgICAgICBpZiAoc2FtcGxlWzNdIDwgdHJhbnMpIHtcbiAgICAgICAgICAgICAgICB0cmFucyA9IHNhbXBsZVszXTtcbiAgICAgICAgICAgICAgICBza2V3ID0gc2FtcGxlWzRdO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHRoaXMuX3NrZXcgPSBza2V3O1xuICAgICAgICB0aGlzLl90cmFucyA9IHRyYW5zO1xuICAgIH1cblxuICAgIGdldCBza2V3KCkge3JldHVybiB0aGlzLl9za2V3O31cbiAgICBnZXQgdHJhbnMoKSB7cmV0dXJuIHRoaXMuX3RyYW5zO31cblxuICAgIG5vdygpIHtcbiAgICAgICAgLy8gc2VydmVyIGNsb2NrIGlzIGxvY2FsIGNsb2NrICsgZXN0aW1hdGVkIHNrZXdcbiAgICAgICAgcmV0dXJuIENMT0NLLm5vdygpICsgdGhpcy5fc2tldztcbiAgICB9XG5cbn1cblxuXG4vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4gICAgUElOR0VSXG4qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuXG4vKipcbiAqIFBpbmdlciBpbnZva2VzIGEgY2FsbGJhY2sgcmVwZWF0ZWRseSwgaW5kZWZpbml0ZWx5LiBcbiAqIFBpbmdpbmcgaW4gMyBzdGFnZXMsIGZpcnN0IGZyZXF1ZW50bHksIHRoZW4gbW9kZXJhdGVseSwgXG4gKiB0aGVuIHNsb3dseS5cbiAqL1xuXG5jb25zdCBTTUFMTF9ERUxBWSA9IDIwOyAvLyBtc1xuY29uc3QgTUVESVVNX0RFTEFZID0gNTAwOyAvLyBtc1xuY29uc3QgTEFSR0VfREVMQVkgPSAxMDAwMDsgLy8gbXNcblxuY29uc3QgREVMQVlfU0VRVUVOQ0UgPSBbXG4gICAgLi4ubmV3IEFycmF5KDMpLmZpbGwoU01BTExfREVMQVkpLCBcbiAgICAuLi5uZXcgQXJyYXkoNykuZmlsbChNRURJVU1fREVMQVkpLFxuICAgIC4uLltMQVJHRV9ERUxBWV1cbl07XG5cbmNsYXNzIFBpbmdlciB7XG5cbiAgICBjb25zdHJ1Y3RvciAoY2FsbGJhY2spIHtcbiAgICAgICAgdGhpcy5fY291bnQgPSAwO1xuICAgICAgICB0aGlzLl90aWQgPSB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMuX2NhbGxiYWNrID0gY2FsbGJhY2s7XG4gICAgICAgIHRoaXMuX3BpbmcgPSB0aGlzLnBpbmcuYmluZCh0aGlzKTtcbiAgICAgICAgdGhpcy5fZGVsYXlzID0gWy4uLkRFTEFZX1NFUVVFTkNFXTtcbiAgICB9XG4gICAgcGF1c2UoKSB7XG4gICAgICAgIGNsZWFyVGltZW91dCh0aGlzLl90aWQpO1xuICAgIH1cbiAgICByZXN1bWUoKSB7XG4gICAgICAgIGNsZWFyVGltZW91dCh0aGlzLl90aWQpO1xuICAgICAgICB0aGlzLnBpbmcoKTtcbiAgICB9XG4gICAgcmVzdGFydCgpIHtcbiAgICAgICAgdGhpcy5fZGVsYXlzID0gWy4uLkRFTEFZX1NFUVVFTkNFXTtcbiAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMuX3RpZCk7XG4gICAgICAgIHRoaXMucGluZygpO1xuICAgIH1cbiAgICBwaW5nICgpIHtcbiAgICAgICAgbGV0IG5leHRfZGVsYXkgPSB0aGlzLl9kZWxheXNbMF07XG4gICAgICAgIGlmICh0aGlzLl9kZWxheXMubGVuZ3RoID4gMSkge1xuICAgICAgICAgICAgdGhpcy5fZGVsYXlzLnNoaWZ0KCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuX2NhbGxiYWNrKSB7XG4gICAgICAgICAgICB0aGlzLl9jYWxsYmFjaygpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX3RpZCA9IHNldFRpbWVvdXQodGhpcy5fcGluZywgbmV4dF9kZWxheSk7XG4gICAgfVxufVxuXG5cbiIsImltcG9ydCB7IFdlYlNvY2tldElPIH0gZnJvbSBcIi4vd3Npby5qc1wiO1xuaW1wb3J0IHsgcmVzb2x2YWJsZVByb21pc2UgfSBmcm9tIFwiLi91dGlsLmpzXCI7XG5pbXBvcnQgeyBQcm94eUNvbGxlY3Rpb24gfSBmcm9tIFwiLi9zc19jb2xsZWN0aW9uLmpzXCI7XG5pbXBvcnQgeyBQcm94eU9iamVjdCB9IGZyb20gXCIuL3NzX29iamVjdC5qc1wiO1xuaW1wb3J0IHsgU2VydmVyQ2xvY2sgfSBmcm9tIFwiLi9zZXJ2ZXJjbG9jay5qc1wiO1xuXG5jb25zdCBNc2dUeXBlID0gT2JqZWN0LmZyZWV6ZSh7XG4gICAgTUVTU0FHRSA6IFwiTUVTU0FHRVwiLFxuICAgIFJFUVVFU1Q6IFwiUkVRVUVTVFwiLFxuICAgIFJFUExZOiBcIlJFUExZXCJcbiB9KTtcbiBcbmNvbnN0IE1zZ0NtZCA9IE9iamVjdC5mcmVlemUoe1xuICAgIEdFVCA6IFwiR0VUXCIsXG4gICAgUFVUOiBcIlBVVFwiLFxuICAgIE5PVElGWTogXCJOT1RJRllcIlxufSk7XG5cblxuZXhwb3J0IGNsYXNzIFNoYXJlZFN0YXRlQ2xpZW50IGV4dGVuZHMgV2ViU29ja2V0SU8ge1xuXG4gICAgY29uc3RydWN0b3IgKHVybCwgb3B0aW9ucykge1xuICAgICAgICBzdXBlcih1cmwsIG9wdGlvbnMpO1xuXG4gICAgICAgIC8vIHJlcXVlc3RzXG4gICAgICAgIHRoaXMuX3JlcWlkID0gMDtcbiAgICAgICAgdGhpcy5fcGVuZGluZyA9IG5ldyBNYXAoKTtcblxuICAgICAgICAvLyBzdWJzY3JpcHRpb25zXG4gICAgICAgIC8vIHBhdGggLT4ge30gXG4gICAgICAgIHRoaXMuX3N1YnNfbWFwID0gbmV3IE1hcCgpO1xuXG4gICAgICAgIC8vIHByb3h5IGNvbGxlY3Rpb25zIHtwYXRoIC0+IHByb3h5IGNvbGxlY3Rpb259XG4gICAgICAgIHRoaXMuX2NvbGxfbWFwID0gbmV3IE1hcCgpO1xuXG4gICAgICAgIC8vIHByb3h5IG9iamVjdHMge1twYXRoLCBpZF0gLT4gcHJveHkgb2JqZWN0fVxuICAgICAgICB0aGlzLl9vYmpfbWFwID0gbmV3IE1hcCgpO1xuXG4gICAgICAgIC8vIHNlcnZlciBjbG9ja1xuICAgICAgICB0aGlzLl9zZXJ2ZXJfY2xvY2s7XG5cbiAgICAgICAgdGhpcy5jb25uZWN0KCk7XG4gICAgfVxuXG4gICAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuICAgICAgICBDT05ORUNUSU9OIFxuICAgICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cblxuICAgIG9uX2Nvbm5lY3QoKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKGBDb25uZWN0ICAke3RoaXMudXJsfWApO1xuICAgICAgICAvLyByZWZyZXNoIGxvY2FsIHN1c2NyaXB0aW9uc1xuICAgICAgICBpZiAodGhpcy5fc3Vic19tYXAuc2l6ZSA+IDApIHtcbiAgICAgICAgICAgIGNvbnN0IGl0ZW1zID0gWy4uLnRoaXMuX3N1YnNfbWFwLmVudHJpZXMoKV07XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZShcIi9zdWJzXCIsIHtpbnNlcnQ6aXRlbXMsIHJlc2V0OnRydWV9KTtcbiAgICAgICAgfVxuICAgICAgICAvLyBzZXJ2ZXIgY2xvY2tcbiAgICAgICAgaWYgKHRoaXMuX3NlcnZlcl9jbG9jayAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHRoaXMuX3NlcnZlcl9jbG9jay5yZXN1bWUoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBvbl9kaXNjb25uZWN0KCkge1xuICAgICAgICBjb25zb2xlLmVycm9yKGBEaXNjb25uZWN0ICR7dGhpcy51cmx9YCk7XG4gICAgICAgIC8vIHNlcnZlciBjbG9ja1xuICAgICAgICBpZiAodGhpcy5fc2VydmVyX2Nsb2NrICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdGhpcy5fc2VydmVyX2Nsb2NrLnBhdXNlKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgb25fZXJyb3IoZXJyb3IpIHtcbiAgICAgICAgY29uc3Qge2RlYnVnPWZhbHNlfSA9IHRoaXMuX29wdGlvbnM7XG4gICAgICAgIGlmIChkZWJ1Zykge2NvbnNvbGUubG9nKGBDb21tdW5pY2F0aW9uIEVycm9yOiAke2Vycm9yfWApO31cbiAgICB9XG5cbiAgICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4gICAgICAgIEhBTkRMRVJTXG4gICAgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuXG4gICAgb25fbWVzc2FnZShkYXRhKSB7XG4gICAgICAgIGxldCBtc2cgPSBKU09OLnBhcnNlKGRhdGEpO1xuICAgICAgICBpZiAobXNnLnR5cGUgPT0gTXNnVHlwZS5SRVBMWSkge1xuICAgICAgICAgICAgbGV0IHJlcWlkID0gbXNnLnR1bm5lbDtcbiAgICAgICAgICAgIGlmICh0aGlzLl9wZW5kaW5nLmhhcyhyZXFpZCkpIHtcbiAgICAgICAgICAgICAgICBsZXQgcmVzb2x2ZXIgPSB0aGlzLl9wZW5kaW5nLmdldChyZXFpZCk7XG4gICAgICAgICAgICAgICAgdGhpcy5fcGVuZGluZy5kZWxldGUocmVxaWQpO1xuICAgICAgICAgICAgICAgIGNvbnN0IHtvaywgZGF0YX0gPSBtc2c7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZXIoe29rLCBkYXRhfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAobXNnLnR5cGUgPT0gTXNnVHlwZS5NRVNTQUdFKSB7XG4gICAgICAgICAgICBpZiAobXNnLmNtZCA9PSBNc2dDbWQuTk9USUZZKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5faGFuZGxlX25vdGlmeShtc2cpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgX2hhbmRsZV9ub3RpZnkobXNnKSB7XG4gICAgICAgIC8vIHVwZGF0ZSBwcm94eSBjb2xsZWN0aW9uIHN0YXRlXG4gICAgICAgIGNvbnN0IGRzID0gdGhpcy5fY29sbF9tYXAuZ2V0KG1zZ1tcInBhdGhcIl0pO1xuICAgICAgICBpZiAoZHMgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBkcy5fc3NjbGllbnRfdXBkYXRlKG1zZ1tcImRhdGFcIl0pO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuICAgICAgICBTRVJWRVIgUkVRVUVTVFNcbiAgICAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG5cbiAgICBfcmVxdWVzdChjbWQsIHBhdGgsIGFyZykge1xuICAgICAgICBjb25zdCByZXFpZCA9IHRoaXMuX3JlcWlkKys7XG4gICAgICAgIGNvbnN0IG1zZyA9IHtcbiAgICAgICAgICAgIHR5cGU6IE1zZ1R5cGUuUkVRVUVTVCxcbiAgICAgICAgICAgIGNtZCwgXG4gICAgICAgICAgICBwYXRoLCBcbiAgICAgICAgICAgIGFyZyxcbiAgICAgICAgICAgIHR1bm5lbDogcmVxaWRcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5zZW5kKEpTT04uc3RyaW5naWZ5KG1zZykpO1xuICAgICAgICBsZXQgW3Byb21pc2UsIHJlc29sdmVyXSA9IHJlc29sdmFibGVQcm9taXNlKCk7XG4gICAgICAgIHRoaXMuX3BlbmRpbmcuc2V0KHJlcWlkLCByZXNvbHZlcik7XG4gICAgICAgIHJldHVybiBwcm9taXNlLnRoZW4oKHtvaywgZGF0YX0pID0+IHtcbiAgICAgICAgICAgIC8vIHNwZWNpYWwgaGFuZGxpbmcgZm9yIHJlcGxpZXMgdG8gUFVUIC9zdWJzXG4gICAgICAgICAgICBpZiAoY21kID09IE1zZ0NtZC5QVVQgJiYgcGF0aCA9PSBcIi9zdWJzXCIgJiYgb2spIHtcbiAgICAgICAgICAgICAgICAvLyB1cGRhdGUgbG9jYWwgc3Vic2NyaXB0aW9uIHN0YXRlXG4gICAgICAgICAgICAgICAgdGhpcy5fc3Vic19tYXAgPSBuZXcgTWFwKGRhdGEpXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4ge29rLCBwYXRoLCBkYXRhfTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgX3N1YiAocGF0aCkge1xuICAgICAgICBpZiAodGhpcy5jb25uZWN0ZWQpIHtcbiAgICAgICAgICAgIC8vIGNvcHkgY3VycmVudCBzdGF0ZSBvZiBzdWJzXG4gICAgICAgICAgICBjb25zdCBzdWJzX21hcCA9IG5ldyBNYXAoWy4uLnRoaXMuX3N1YnNfbWFwXSk7XG4gICAgICAgICAgICAvLyBzZXQgbmV3IHBhdGhcbiAgICAgICAgICAgIHN1YnNfbWFwLnNldChwYXRoLCB7fSk7XG4gICAgICAgICAgICAvLyByZXNldCBzdWJzIG9uIHNlcnZlclxuICAgICAgICAgICAgY29uc3QgaXRlbXMgPSBbLi4udGhpcy5fc3Vic19tYXAuZW50cmllcygpXTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnVwZGF0ZShcIi9zdWJzXCIsIHtpbnNlcnQ6aXRlbXMsIHJlc2V0OnRydWV9KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIHVwZGF0ZSBsb2NhbCBzdWJzIC0gc3Vic2NyaWJlIG9uIHJlY29ubmVjdFxuICAgICAgICAgICAgdGhpcy5fc3Vic19tYXAuc2V0KHBhdGgsIHt9KTtcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoe29rOiB0cnVlLCBwYXRoLCBkYXRhOnVuZGVmaW5lZH0pXG4gICAgICAgIH1cblxuICAgIH1cblxuICAgIF91bnN1YiAocGF0aCkge1xuICAgICAgICAvLyBjb3B5IGN1cnJlbnQgc3RhdGUgb2Ygc3Vic1xuICAgICAgICBjb25zdCBzdWJzX21hcCA9IG5ldyBNYXAoWy4uLnRoaXMuX3N1YnNfbWFwXSk7XG4gICAgICAgIC8vIHJlbW92ZSBwYXRoXG4gICAgICAgIHN1YnNfbWFwLmRlbGV0ZShwYXRoKVxuICAgICAgICAvLyByZXNldCBzdWJzIG9uIHNlcnZlclxuICAgICAgICBjb25zdCBpdGVtcyA9IFsuLi5zdWJzX21hcC5lbnRyaWVzKCldO1xuICAgICAgICByZXR1cm4gdGhpcy51cGRhdGUoXCIvc3Vic1wiLCB7aW5zZXJ0Oml0ZW1zLCByZXNldDp0cnVlfSk7XG4gICAgfVxuXG4gICAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuICAgICAgICBBUElcbiAgICAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG5cbiAgICAvLyBhY2NzZXNzb3IgZm9yIHNlcnZlciBjbG9ja1xuICAgIGdldCBjbG9jaygpIHtcbiAgICAgICAgaWYgKHRoaXMuX3NlcnZlcl9jbG9jayA9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHRoaXMuX3NlcnZlcl9jbG9jayA9IG5ldyBTZXJ2ZXJDbG9jayh0aGlzKTtcbiAgICAgICAgICAgIGlmICh0aGlzLmNvbm5lY3RlZCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX3NlcnZlcl9jbG9jay5yZXN1bWUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5fc2VydmVyX2Nsb2NrO1xuICAgIH1cblxuICAgIC8vIGdldCByZXF1ZXN0IGZvciBpdGVtcyBieSBwYXRoXG4gICAgZ2V0KHBhdGgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoTXNnQ21kLkdFVCwgcGF0aCk7XG4gICAgfVxuICAgIFxuICAgIC8vIHVwZGF0ZSByZXF1ZXN0IGZvciBwYXRoXG4gICAgdXBkYXRlKHBhdGgsIGNoYW5nZXMpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoTXNnQ21kLlBVVCwgcGF0aCwgY2hhbmdlcyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogYWNxdWlyZSBwcm94eSBjb2xsZWN0aW9uIGZvciBwYXRoXG4gICAgICogLSBhdXRvbWF0aWNhbGx5IHN1YnNjcmliZXMgdG8gcGF0aCBpZiBuZWVkZWRcbiAgICAgKi9cbiAgICBhY3F1aXJlX2NvbGxlY3Rpb24gKHBhdGgsIG9wdGlvbnMpIHtcbiAgICAgICAgcGF0aCA9IHBhdGguc3RhcnRzV2l0aChcIi9cIikgPyBwYXRoIDogXCIvXCIgKyBwYXRoO1xuICAgICAgICAvLyBzdWJzY3JpYmUgaWYgc3Vic2NyaXB0aW9uIGRvZXMgbm90IGV4aXN0c1xuICAgICAgICBpZiAoIXRoaXMuX3N1YnNfbWFwLmhhcyhwYXRoKSkge1xuICAgICAgICAgICAgLy8gc3Vic2NyaWJlIHRvIHBhdGhcbiAgICAgICAgICAgIHRoaXMuX3N1YihwYXRoKTtcbiAgICAgICAgfVxuICAgICAgICAvLyBjcmVhdGUgY29sbGVjdGlvbiBpZiBub3QgZXhpc3RzXG4gICAgICAgIGlmICghdGhpcy5fY29sbF9tYXAuaGFzKHBhdGgpKSB7XG4gICAgICAgICAgICB0aGlzLl9jb2xsX21hcC5zZXQocGF0aCwgbmV3IFByb3h5Q29sbGVjdGlvbih0aGlzLCBwYXRoLCBvcHRpb25zKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMuX2NvbGxfbWFwLmdldChwYXRoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBhY3F1aXJlIG9iamVjdCBmb3IgKHBhdGgsIG5hbWUpXG4gICAgICogLSBhdXRvbWF0aWNhbGx5IGFjcXVpcmUgcHJveHkgY29sbGVjdGlvblxuICAgICAqL1xuICAgIGFjcXVpcmVfb2JqZWN0IChwYXRoLCBuYW1lLCBvcHRpb25zKSB7XG4gICAgICAgIHBhdGggPSBwYXRoLnN0YXJ0c1dpdGgoXCIvXCIpID8gcGF0aCA6IFwiL1wiICsgcGF0aDtcbiAgICAgICAgY29uc3QgZHMgPSB0aGlzLmFjcXVpcmVfY29sbGVjdGlvbihwYXRoKTtcbiAgICAgICAgLy8gY3JlYXRlIHByb3h5IG9iamVjdCBpZiBub3QgZXhpc3RzXG4gICAgICAgIGlmICghdGhpcy5fb2JqX21hcC5oYXMocGF0aCkpIHtcbiAgICAgICAgICAgIHRoaXMuX29ial9tYXAuc2V0KHBhdGgsIG5ldyBNYXAoKSk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3Qgb2JqX21hcCA9IHRoaXMuX29ial9tYXAuZ2V0KHBhdGgpO1xuICAgICAgICBpZiAoIW9ial9tYXAuZ2V0KG5hbWUpKSB7XG4gICAgICAgICAgICBvYmpfbWFwLnNldChuYW1lLCBuZXcgUHJveHlPYmplY3QoZHMsIG5hbWUsIG9wdGlvbnMpKVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvYmpfbWFwLmdldChuYW1lKVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIHJlbGVhc2UgcGF0aCwgaW5jbHVkaW5nIHByb3h5IGNvbGxlY3Rpb24gYW5kIHByb3h5IG9iamVjdHNcbiAgICAgKi9cbiAgICByZWxlYXNlKHBhdGgpIHtcbiAgICAgICAgLy8gdW5zdWJzY3JpYmVcbiAgICAgICAgaWYgKHRoaXMuX3N1YnNfbWFwLmhhcyhwYXRoKSkge1xuICAgICAgICAgICAgdGhpcy5fdW5zdWIocGF0aCk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gdGVybWluYXRlIHByb3h5IGNvbGxlY3Rpb24gYW5kIHByb3h5IG9iamVjdHNcbiAgICAgICAgY29uc3QgZHMgPSB0aGlzLl9jb2xsX21hcC5nZXQocGF0aCk7XG4gICAgICAgIGRzLl9zc2NsaWVudF90ZXJtaW5hdGUoKTtcbiAgICAgICAgY29uc3Qgb2JqX21hcCA9IHRoaXMuX29ial9tYXAuZ2V0KHBhdGgpO1xuICAgICAgICBpZiAob2JqX21hcCAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIGZvciAoY29uc3QgdiBvZiBvYmpfbWFwLnZhbHVlcygpKSB7XG4gICAgICAgICAgICAgICAgdi5fc3NjbGllbnRfdGVybWluYXRlKCk7XG4gICAgICAgICAgICB9ICAgIFxuICAgICAgICB9XG4gICAgICAgIHRoaXMuX2NvbGxfbWFwLmRlbGV0ZShwYXRoKTtcbiAgICAgICAgdGhpcy5fb2JqX21hcC5kZWxldGUocGF0aCk7XG4gICAgfVxufVxuXG5cbiIsIi8qXG4gICAgQ29sbGVjdGlvbiBWaWV3ZXJcbiovXG5cbmZ1bmN0aW9uIGl0ZW0yc3RyaW5nKGl0ZW0pIHtcbiAgICBjb25zdCB7aWQsIGl0diwgZGF0YX0gPSBpdGVtO1xuICAgIGxldCBkYXRhX3R4dCA9IEpTT04uc3RyaW5naWZ5KGRhdGEpO1xuICAgIGxldCBpdHZfdHh0ID0gKGl0diAhPSB1bmRlZmluZWQpID8gSlNPTi5zdHJpbmdpZnkoaXR2KSA6IFwiXCI7XG4gICAgbGV0IGlkX2h0bWwgPSBgPHNwYW4gY2xhc3M9XCJpZFwiPiR7aWR9PC9zcGFuPmA7XG4gICAgbGV0IGl0dl9odG1sID0gYDxzcGFuIGNsYXNzPVwiaXR2XCI+JHtpdHZfdHh0fTwvc3Bhbj5gO1xuICAgIGxldCBkYXRhX2h0bWwgPSBgPHNwYW4gY2xhc3M9XCJkYXRhXCI+JHtkYXRhX3R4dH08L3NwYW4+YDtcbiAgICByZXR1cm4gYFxuICAgICAgICA8ZGl2PlxuICAgICAgICAgICAgPGJ1dHRvbiBpZD1cImRlbGV0ZVwiPlg8L2J1dHRvbj5cbiAgICAgICAgICAgICR7aWRfaHRtbH06ICR7aXR2X2h0bWx9ICR7ZGF0YV9odG1sfVxuICAgICAgICA8L2Rpdj5gO1xufVxuXG5cbmV4cG9ydCBjbGFzcyBDb2xsZWN0aW9uVmlld2VyIHtcblxuICAgIGNvbnN0cnVjdG9yKGNvbGxlY3Rpb24sIGVsZW0sIG9wdGlvbnM9e30pIHtcbiAgICAgICAgdGhpcy5fY29sbCA9IGNvbGxlY3Rpb247XG4gICAgICAgIHRoaXMuX2VsZW0gPSBlbGVtO1xuICAgICAgICB0aGlzLl9oYW5kbGUgPSB0aGlzLl9jb2xsLmFkZF9jYWxsYmFjayh0aGlzLl9vbmNoYW5nZS5iaW5kKHRoaXMpKTsgXG5cbiAgICAgICAgLy8gb3B0aW9uc1xuICAgICAgICBsZXQgZGVmYXVsdHMgPSB7XG4gICAgICAgICAgICBkZWxldGU6ZmFsc2UsXG4gICAgICAgICAgICB0b1N0cmluZzppdGVtMnN0cmluZ1xuICAgICAgICB9O1xuICAgICAgICB0aGlzLl9vcHRpb25zID0gey4uLmRlZmF1bHRzLCAuLi5vcHRpb25zfTtcblxuICAgICAgICAvKlxuICAgICAgICAgICAgU3VwcG9ydCBkZWxldGVcbiAgICAgICAgKi9cbiAgICAgICAgaWYgKHRoaXMuX29wdGlvbnMuZGVsZXRlKSB7XG4gICAgICAgICAgICAvLyBsaXN0ZW4gZm9yIGNsaWNrIGV2ZW50cyBvbiByb290IGVsZW1lbnRcbiAgICAgICAgICAgIGVsZW0uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XG4gICAgICAgICAgICAgICAgLy8gY2F0Y2ggY2xpY2sgZXZlbnQgZnJvbSBkZWxldGUgYnV0dG9uXG4gICAgICAgICAgICAgICAgY29uc3QgZGVsZXRlQnRuID0gZS50YXJnZXQuY2xvc2VzdChcIiNkZWxldGVcIik7XG4gICAgICAgICAgICAgICAgaWYgKGRlbGV0ZUJ0bikge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBsaXN0SXRlbSA9IGRlbGV0ZUJ0bi5jbG9zZXN0KFwiLmxpc3QtaXRlbVwiKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGxpc3RJdGVtKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9jb2xsLnVwZGF0ZSh7cmVtb3ZlOltsaXN0SXRlbS5pZF19KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qXG4gICAgICAgICAgICByZW5kZXIgaW5pdGlhbCBzdGF0ZVxuICAgICAgICAqLyBcbiAgICAgICAgY29uc3QgZGlmZnMgPSB0aGlzLl9jb2xsLmdldCgpXG4gICAgICAgICAgICAubWFwKGl0ZW0gPT4ge1xuICAgICAgICAgICAgICAgIHJldHVybiB7aWQ6aXRlbS5pZCwgbmV3Oml0ZW19XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5fb25jaGFuZ2UoZGlmZnMpO1xuICAgIH1cblxuICAgIF9vbmNoYW5nZShkaWZmcykge1xuICAgICAgICBjb25zdCB7dG9TdHJpbmd9ID0gdGhpcy5fb3B0aW9ucztcbiAgICAgICAgZm9yIChsZXQgZGlmZiBvZiBkaWZmcykge1xuICAgICAgICAgICAgaWYgKGRpZmYubmV3KSB7XG4gICAgICAgICAgICAgICAgLy8gYWRkXG4gICAgICAgICAgICAgICAgbGV0IG5vZGUgPSB0aGlzLl9lbGVtLnF1ZXJ5U2VsZWN0b3IoYCMke2RpZmYuaWR9YCk7XG4gICAgICAgICAgICAgICAgaWYgKG5vZGUgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICBub2RlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICAgICAgICAgICAgICAgICAgbm9kZS5zZXRBdHRyaWJ1dGUoXCJpZFwiLCBkaWZmLmlkKTtcbiAgICAgICAgICAgICAgICAgICAgbm9kZS5jbGFzc0xpc3QuYWRkKFwibGlzdC1pdGVtXCIpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9lbGVtLmFwcGVuZENoaWxkKG5vZGUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBub2RlLmlubmVySFRNTCA9IHRvU3RyaW5nKGRpZmYubmV3KTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoZGlmZi5vbGQpIHtcbiAgICAgICAgICAgICAgICAvLyByZW1vdmVcbiAgICAgICAgICAgICAgICBsZXQgbm9kZSA9IHRoaXMuX2VsZW0ucXVlcnlTZWxlY3RvcihgIyR7ZGlmZi5pZH1gKTtcbiAgICAgICAgICAgICAgICBpZiAobm9kZSkge1xuICAgICAgICAgICAgICAgICAgICBub2RlLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQobm9kZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxufVxuIl0sIm5hbWVzIjpbInJlc29sdmFibGVQcm9taXNlIiwicmVzb2x2ZXIiLCJQcm9taXNlIiwicmVzb2x2ZSIsInJlamVjdCIsIk1BWF9SRVRSSUVTIiwiV2ViU29ja2V0SU8iLCJjb25zdHJ1Y3RvciIsInVybCIsIm9wdGlvbnMiLCJ0aGlzIiwiX3VybCIsIl93cyIsIl9jb25uZWN0aW5nIiwiX2Nvbm5lY3RlZCIsIl9vcHRpb25zIiwiX3JldHJpZXMiLCJfY29ubmVjdF9wcm9taXNlX3Jlc29sdmVycyIsImNvbm5lY3RpbmciLCJjb25uZWN0ZWQiLCJjb25uZWN0IiwiY29uc29sZSIsImxvZyIsIl9pc190ZXJtaW5hdGVkIiwiV2ViU29ja2V0Iiwib25vcGVuIiwiZSIsIl9vbl9vcGVuIiwib25tZXNzYWdlIiwib25fbWVzc2FnZSIsImRhdGEiLCJvbmNsb3NlIiwiX29uX2Nsb3NlIiwib25lcnJvciIsIm9uX2Vycm9yIiwib25fY29ubmVjdGluZyIsImV2ZW50Iiwib25fY29ubmVjdCIsIm9uX2Rpc2Nvbm5lY3QiLCJzZXRUaW1lb3V0IiwicmV0cmllcyIsInVuZGVmaW5lZCIsImRlYnVnIiwiZXJyb3IiLCJzZW5kIiwiY29ubmVjdGVkUHJvbWlzZSIsInByb21pc2UiLCJwdXNoIiwiUHJveHlDb2xsZWN0aW9uIiwic3NjbGllbnQiLCJwYXRoIiwiX3Rlcm1pbmF0ZWQiLCJfc3NjbGllbnQiLCJfcGF0aCIsIl9oYW5kbGVycyIsIl9tYXAiLCJNYXAiLCJfc3NjbGllbnRfdGVybWluYXRlIiwiX3NzY2xpZW50X3VwZGF0ZSIsImNoYW5nZXMiLCJFcnJvciIsInJlbW92ZSIsImluc2VydCIsInJlc2V0IiwiZGlmZl9tYXAiLCJpdGVtIiwidmFsdWVzIiwic2V0IiwiaWQiLCJuZXciLCJvbGQiLCJfaWQiLCJnZXQiLCJkZWxldGUiLCJkaWZmIiwiX25vdGlmeV9jYWxsYmFja3MiLCJlQXJnIiwiZm9yRWFjaCIsImhhbmRsZSIsImhhbmRsZXIiLCJzaXplIiwiaGFzIiwidXBkYXRlIiwibWFwIiwibGVuZ3RoIiwidGV4dCIsInBvc3NpYmxlIiwiaSIsImNoYXJBdCIsIk1hdGgiLCJmbG9vciIsInJhbmRvbSIsInJhbmRvbV9zdHJpbmciLCJhZGRfY2FsbGJhY2siLCJyZW1vdmVfY2FsbGJhY2siLCJpbmRleCIsImluZGV4T2YiLCJzcGxpY2UiLCJQcm94eU9iamVjdCIsInByb3h5Q29sbGVjdGlvbiIsIl90ZXJtaW5pYXRlZCIsIl9jb2xsIiwiX2hhbmRsZSIsIl9vbmNoYW5nZSIsImJpbmQiLCJkaWZmcyIsIm5vdGlmeV9jYWxsYmFja3MiLCJfaGFuZGVycyIsIm9iaiIsIml0ZW1zIiwic3NfY2xpZW50X3Rlcm1pbmF0ZSIsImxvY2FsIiwicGVyZm9ybWFuY2UiLCJub3ciLCJlcG9jaCIsIkRhdGUiLCJDTE9DSyIsInQwX2xvY2FsIiwidDBfZXBvY2giLCJ0MV9sb2NhbCIsIlNlcnZlckNsb2NrIiwiX3BpbmdlciIsIlBpbmdlciIsIl9vbnBpbmciLCJfc2FtcGxlcyIsIl90cmFucyIsIl9za2V3IiwicmVzdW1lIiwicGF1c2UiLCJ0czAiLCJ0aGVuIiwib2siLCJ0czEiLCJfYWRkX3NhbXBsZSIsImNzIiwic3MiLCJjciIsInRyYW5zIiwic2tldyIsInNhbXBsZSIsInNoaWZ0IiwiREVMQVlfU0VRVUVOQ0UiLCJBcnJheSIsImZpbGwiLCJjYWxsYmFjayIsIl9jb3VudCIsIl90aWQiLCJfY2FsbGJhY2siLCJfcGluZyIsInBpbmciLCJfZGVsYXlzIiwiY2xlYXJUaW1lb3V0IiwicmVzdGFydCIsIm5leHRfZGVsYXkiLCJNc2dUeXBlIiwiT2JqZWN0IiwiZnJlZXplIiwiTUVTU0FHRSIsIlJFUVVFU1QiLCJSRVBMWSIsIk1zZ0NtZCIsIkdFVCIsIlBVVCIsIk5PVElGWSIsIml0ZW0yc3RyaW5nIiwiaXR2IiwiZGF0YV90eHQiLCJKU09OIiwic3RyaW5naWZ5IiwiY29sbGVjdGlvbiIsImVsZW0iLCJfZWxlbSIsImRlZmF1bHRzIiwidG9TdHJpbmciLCJhZGRFdmVudExpc3RlbmVyIiwiZGVsZXRlQnRuIiwidGFyZ2V0IiwiY2xvc2VzdCIsImxpc3RJdGVtIiwic3RvcFByb3BhZ2F0aW9uIiwibm9kZSIsInF1ZXJ5U2VsZWN0b3IiLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJzZXRBdHRyaWJ1dGUiLCJjbGFzc0xpc3QiLCJhZGQiLCJhcHBlbmRDaGlsZCIsImlubmVySFRNTCIsInBhcmVudE5vZGUiLCJyZW1vdmVDaGlsZCIsInN1cGVyIiwiX3JlcWlkIiwiX3BlbmRpbmciLCJfc3Vic19tYXAiLCJfY29sbF9tYXAiLCJfb2JqX21hcCIsIl9zZXJ2ZXJfY2xvY2siLCJlbnRyaWVzIiwibXNnIiwicGFyc2UiLCJ0eXBlIiwicmVxaWQiLCJ0dW5uZWwiLCJjbWQiLCJfaGFuZGxlX25vdGlmeSIsImRzIiwiX3JlcXVlc3QiLCJhcmciLCJfc3ViIiwiX3Vuc3ViIiwic3Vic19tYXAiLCJjbG9jayIsImFjcXVpcmVfY29sbGVjdGlvbiIsInN0YXJ0c1dpdGgiLCJhY3F1aXJlX29iamVjdCIsIm5hbWUiLCJvYmpfbWFwIiwicmVsZWFzZSIsInYiXSwibWFwcGluZ3MiOiJ5Q0FNTyxTQUFTQSxJQUNaLElBQUlDLEVBSUosTUFBTyxDQUhPLElBQUlDLFNBQVEsQ0FBQ0MsRUFBU0MsS0FDaENILEVBQVdFLENBQU8sSUFFTEYsRUFDckIsQ0NWQSxNQUFNSSxFQUFjLEVBRWIsTUFBTUMsRUFFVCxXQUFBQyxDQUFZQyxFQUFLQyxFQUFRLElBQ3JCQyxLQUFLQyxLQUFPSCxFQUNaRSxLQUFLRSxJQUNMRixLQUFLRyxhQUFjLEVBQ25CSCxLQUFLSSxZQUFhLEVBQ2xCSixLQUFLSyxTQUFXTixFQUNoQkMsS0FBS00sU0FBVyxFQUNoQk4sS0FBS08sMkJBQTZCLEVBQzFDLENBRUksY0FBSUMsR0FBYyxPQUFPUixLQUFLRyxXQUFZLENBQzFDLGFBQUlNLEdBQWEsT0FBT1QsS0FBS0ksVUFBVyxDQUN4QyxPQUFJTixHQUFPLE9BQU9FLEtBQUtDLElBQUssQ0FDNUIsV0FBSUYsR0FBVyxPQUFPQyxLQUFLSyxRQUFTLENBRXBDLE9BQUFLLEdBRVFWLEtBQUtRLFlBQWNSLEtBQUtTLFVBQ3hCRSxRQUFRQyxJQUFJLHlDQUdaWixLQUFLYSxpQkFDTEYsUUFBUUMsSUFBSSxlQUtoQlosS0FBS0UsSUFBTSxJQUFJWSxVQUFVZCxLQUFLQyxNQUM5QkQsS0FBS0csYUFBYyxFQUNuQkgsS0FBS0UsSUFBSWEsT0FBU0MsR0FBS2hCLEtBQUtpQixTQUFTRCxHQUNyQ2hCLEtBQUtFLElBQUlnQixVQUFZRixHQUFLaEIsS0FBS21CLFdBQVdILEVBQUVJLE1BQzVDcEIsS0FBS0UsSUFBSW1CLFFBQVVMLEdBQUtoQixLQUFLc0IsVUFBVU4sR0FDdkNoQixLQUFLRSxJQUFJcUIsUUFBVVAsR0FBS2hCLEtBQUt3QixTQUFTUixHQUN0Q2hCLEtBQUt5QixnQkFDYixDQUVJLFFBQUFSLENBQVNTLEdBQ0wxQixLQUFLRyxhQUFjLEVBQ25CSCxLQUFLSSxZQUFhLEVBRWxCLElBQUssTUFBTWIsS0FBWVMsS0FBS08sMkJBQ3hCaEIsSUFFSlMsS0FBS08sMkJBQTZCLEdBRWxDUCxLQUFLTSxTQUFXLEVBQ2hCTixLQUFLMkIsWUFDYixDQUVJLFNBQUFMLENBQVVJLEdBQ04xQixLQUFLRyxhQUFjLEVBQ25CSCxLQUFLSSxZQUFhLEVBQ2xCSixLQUFLNEIsY0FBY0YsR0FDbkIxQixLQUFLTSxVQUFZLEVBQ1pOLEtBQUthLGtCQUNOZ0IsWUFBVyxLQUNQN0IsS0FBS1UsU0FBUyxHQUNmLElBQU9WLEtBQUtNLFNBRTNCLENBRUksY0FBQU8sR0FDSSxNQUFNaUIsUUFBQ0EsRUFBUW5DLEdBQWVLLEtBQUtLLFNBQ25DLE9BQUlMLEtBQUtNLFVBQVl3QixJQUNqQm5CLFFBQVFDLElBQUksb0NBQW9Da0IsTUFDaEQ5QixLQUFLRyxhQUFjLEVBQ25CSCxLQUFLSSxZQUFhLEVBQ2xCSixLQUFLRSxJQUFJYSxZQUFTZ0IsRUFDbEIvQixLQUFLRSxJQUFJZ0IsZUFBWWEsRUFDckIvQixLQUFLRSxJQUFJbUIsYUFBVVUsRUFDbkIvQixLQUFLRSxJQUFJcUIsYUFBVVEsRUFDbkIvQixLQUFLRSxTQUFNNkIsR0FDSixFQUduQixDQUVJLGFBQUFOLEdBQ0ksTUFBTU8sTUFBQ0EsR0FBTSxHQUFTaEMsS0FBS0ssU0FDdkIyQixHQUFRckIsUUFBUUMsSUFBSSxjQUFjWixLQUFLRixNQUNuRCxDQUNJLFVBQUE2QixHQUNJaEIsUUFBUUMsSUFBSSxZQUFZWixLQUFLRixNQUNyQyxDQUNJLFFBQUEwQixDQUFTUyxHQUNMLE1BQU1ELE1BQUNBLEdBQU0sR0FBU2hDLEtBQUtLLFNBQ3ZCMkIsR0FBUXJCLFFBQVFDLElBQUksVUFBVXFCLElBQzFDLENBQ0ksYUFBQUwsQ0FBY0YsR0FDVmYsUUFBUXNCLE1BQU0sY0FBY2pDLEtBQUtGLE1BQ3pDLENBQ0ksVUFBQXFCLENBQVdDLEdBQ1AsTUFBTVksTUFBQ0EsR0FBTSxHQUFTaEMsS0FBS0ssU0FDdkIyQixHQUFRckIsUUFBUUMsSUFBSSxZQUFZUSxJQUM1QyxDQUVJLElBQUFjLENBQUtkLEdBQ0QsR0FBSXBCLEtBQUtJLFdBQ0wsSUFDSUosS0FBS0UsSUFBSWdDLEtBQUtkLEVBQ2pCLENBQUMsTUFBT2EsR0FDTHRCLFFBQVFzQixNQUFNLGNBQWNBLElBQzVDLE1BRVl0QixRQUFRQyxJQUFJLDRCQUV4QixDQUVJLGdCQUFBdUIsR0FDSSxNQUFPQyxFQUFTN0MsR0FBWUQsSUFNNUIsT0FMSVUsS0FBS1MsVUFDTGxCLElBRUFTLEtBQUtPLDJCQUEyQjhCLEtBQUs5QyxHQUVsQzZDLENBQ2YsRUN4SE8sTUFBTUUsRUFFVCxXQUFBekMsQ0FBWTBDLEVBQVVDLEVBQU16QyxFQUFRLENBQUEsR0FDaENDLEtBQUtLLFNBQVdOLEVBQ2hCQyxLQUFLeUMsYUFBYyxFQUVuQnpDLEtBQUswQyxVQUFZSCxFQUNqQnZDLEtBQUsyQyxNQUFRSCxFQUVieEMsS0FBSzRDLFVBQVksR0FFakI1QyxLQUFLNkMsS0FBTyxJQUFJQyxHQUN4QixDQVVJLG1CQUFBQyxHQUNJL0MsS0FBS3lDLGFBQWMsRUFHbkJ6QyxLQUFLNEMsVUFBWSxFQUN6QixDQUtJLGdCQUFBSSxDQUFrQkMsRUFBUSxJQUV0QixHQUFJakQsS0FBS3lDLFlBQ0wsTUFBTSxJQUFJUyxNQUFNLGlDQUdwQixNQUFNQyxPQUFDQSxFQUFNQyxPQUFFQSxFQUFNQyxNQUFFQSxHQUFNLEdBQVNKLEVBQ2hDSyxFQUFXLElBQUlSLElBR3JCLEdBQUlPLEVBQU8sQ0FDUCxJQUFLLE1BQU1FLEtBQVF2RCxLQUFLNkMsS0FBS1csU0FDekJGLEVBQVNHLElBQ0xGLEVBQUtHLEdBQ0wsQ0FBQ0EsR0FBSUgsRUFBS0csR0FBSUMsU0FBSTVCLEVBQVc2QixJQUFJTCxJQUd6Q3ZELEtBQUs2QyxLQUFPLElBQUlDLEdBQzVCLE1BQ1ksSUFBSyxNQUFNZSxLQUFPVixFQUFRLENBQ3RCLE1BQU1TLEVBQU01RCxLQUFLNkMsS0FBS2lCLElBQUlELEdBQ2Y5QixNQUFQNkIsSUFDQTVELEtBQUs2QyxLQUFLa0IsT0FBT0YsR0FDakJQLEVBQVNHLElBQUlJLEVBQUssQ0FBQ0gsR0FBR0csRUFBS0YsU0FBSTVCLEVBQVc2QixRQUU5RCxDQUlRLElBQUssTUFBTUwsS0FBUUgsRUFBUSxDQUN2QixNQUFNUyxFQUFNTixFQUFLRyxHQUVYTSxFQUFPVixFQUFTUSxJQUFJRCxHQUNwQkQsRUFBZTdCLE1BQVJpQyxFQUFxQkEsRUFBS0osSUFBTTVELEtBQUs2QyxLQUFLaUIsSUFBSUQsR0FFM0Q3RCxLQUFLNkMsS0FBS1ksSUFBSUksRUFBS04sR0FFbkJELEVBQVNHLElBQUlJLEVBQUssQ0FBQ0gsR0FBR0csRUFBS0YsSUFBSUosRUFBTUssT0FDakQsQ0FDUTVELEtBQUtpRSxrQkFBa0IsSUFBSVgsRUFBU0UsVUFDNUMsQ0FFSSxpQkFBQVMsQ0FBbUJDLEdBQ2ZsRSxLQUFLNEMsVUFBVXVCLFNBQVEsU0FBU0MsR0FDNUJBLEVBQU9DLFFBQVFILEVBQzNCLEdBQ0ssQ0FNRCxRQUFJSSxHQUFRLE9BQU90RSxLQUFLNkMsS0FBS3lCLElBQUksQ0FDakMsR0FBQUMsQ0FBSWIsR0FBSyxPQUFPMUQsS0FBSzZDLEtBQUswQixJQUFJYixFQUFHLENBQ2pDLEdBQUFJLENBQUlKLEdBQ0EsT0FBVTNCLE1BQU4yQixFQUNPLElBQUkxRCxLQUFLNkMsS0FBS1csVUFFZHhELEtBQUs2QyxLQUFLaUIsSUFBSUosRUFFakMsQ0FLSSxNQUFBYyxDQUFRdkIsRUFBUSxJQUNaLEdBQUlqRCxLQUFLeUMsWUFDTCxNQUFNLElBQUlTLE1BQU0saUNBR3BCLE1BQU1FLE9BQUNBLEVBQU8sSUFBTUgsRUFLcEIsT0FKQUEsRUFBUUcsT0FBU0EsRUFBT3FCLEtBQUtsQixJQUN6QkEsRUFBS0csR0FBS0gsRUFBS0csSUYzRXBCLFNBQXVCZ0IsR0FHMUIsSUFGQSxJQUFJQyxFQUFPLEdBQ1BDLEVBQVcsdURBQ1BDLEVBQUksRUFBR0EsRUFBSUgsRUFBUUcsSUFDdkJGLEdBQVFDLEVBQVNFLE9BQU9DLEtBQUtDLE1BQXNCSixHQUFoQkcsS0FBS0UsV0FFNUMsT0FBT04sQ0FDWCxDRW9FaUNPLENBQWMsSUFDNUIzQixLQUVKdkQsS0FBSzBDLFVBQVU4QixPQUFPeEUsS0FBSzJDLE1BQU9NLEVBQ2pELENBS0ksWUFBQWtDLENBQWNkLEdBQ1YsTUFBTUQsRUFBUyxDQUFDQyxXQUVoQixPQURBckUsS0FBSzRDLFVBQVVQLEtBQUsrQixHQUNiQSxDQUNWLENBQ0QsZUFBQWdCLENBQWlCaEIsR0FDYixNQUFNaUIsRUFBUXJGLEtBQUs0QyxVQUFVMEMsUUFBUWxCLEdBQ2pDaUIsR0FBUSxHQUNSckYsS0FBSzRDLFVBQVUyQyxPQUFPRixFQUFPLEVBRXBDLEVDOUdFLE1BQU1HLEVBRVQsV0FBQTNGLENBQVk0RixFQUFpQi9CLEVBQUkzRCxFQUFRLENBQUEsR0FDckNDLEtBQUswRixjQUFlLEVBQ3BCMUYsS0FBSzJGLE1BQVFGLEVBQ2J6RixLQUFLNkQsSUFBTUgsRUFDWDFELEtBQUtLLFNBQVdOLEVBRWhCQyxLQUFLNEMsVUFBWSxHQUNqQjVDLEtBQUs0RixRQUFVNUYsS0FBSzJGLE1BQU1SLGFBQWFuRixLQUFLNkYsVUFBVUMsS0FBSzlGLE1BQ25FLENBRUksU0FBQTZGLENBQVVFLEdBQ04sR0FBSS9GLEtBQUt5QyxZQUNMLE1BQU0sSUFBSVMsTUFBTSwyQkFFcEIsSUFBSyxNQUFNYyxLQUFRK0IsRUFDWC9CLEVBQUtOLElBQU0xRCxLQUFLNkQsS0FDaEI3RCxLQUFLZ0csaUJBQWlCaEMsRUFHdEMsQ0FFSSxZQUFBbUIsQ0FBY2QsR0FDVixNQUFNRCxFQUFTLENBQUNDLFFBQVNBLEdBRXpCLE9BREFyRSxLQUFLNEMsVUFBVVAsS0FBSytCLEdBQ2JBLENBQ1YsQ0FFRCxlQUFBZ0IsQ0FBaUJoQixHQUNiLElBQUlpQixFQUFRckYsS0FBSzRDLFVBQVUwQyxRQUFRbEIsR0FDL0JpQixHQUFRLEdBQ1JyRixLQUFLaUcsU0FBU1YsT0FBT0YsRUFBTyxFQUVuQyxDQUVELGdCQUFBVyxDQUFrQjlCLEdBQ2RsRSxLQUFLNEMsVUFBVXVCLFNBQVEsU0FBU0MsR0FDNUJBLEVBQU9DLFFBQVFILEVBQzNCLEdBQ0ssQ0FHRCxHQUFBVCxDQUFLeUMsR0FDRCxHQUFJbEcsS0FBS3lDLFlBQ0wsTUFBTSxJQUFJUyxNQUFNLDJCQUVwQixNQUFNaUQsRUFBUSxDQUFDLENBQUN6QyxHQUFHMUQsS0FBSzZELElBQUt6QyxLQUFLOEUsSUFDbEMsT0FBT2xHLEtBQUsyRixNQUFNbkIsT0FBTyxDQUFDcEIsT0FBTytDLEVBQU85QyxPQUFNLEdBQ3RELENBRUksR0FBQVMsR0FDSSxPQUFJOUQsS0FBSzJGLE1BQU1wQixJQUFJdkUsS0FBSzZELEtBQ2I3RCxLQUFLMkYsTUFBTTdCLElBQUk5RCxLQUFLNkQsS0FBS3pDLFVBRWhDLENBRVosQ0FFSSxtQkFBQWdGLEdBQ0lwRyxLQUFLeUMsYUFBYyxFQUNuQnpDLEtBQUsyRixNQUFNUCxnQkFBZ0JwRixLQUFLNEYsUUFDeEMsRUM1RUEsTUFBTVMsRUFDRyxXQUNELE9BQU9DLFlBQVlDLE1BQU0sR0FDakMsRUFHTUMsRUFDRyxXQUNELE9BQU8sSUFBSUMsS0FBTyxHQUMxQixFQVVNQyxFQUFRLFdBQ1YsTUFBTUMsRUFBV04sSUFDWE8sRUFBV0osSUFDakIsTUFBTyxDQUNIRCxJQUFLLFdBQ0QsTUFBTU0sRUFBV1IsSUFDakIsT0FBT08sR0FBWUMsRUFBV0YsRUFDMUMsRUFFQSxDQVRjLEdBa0JQLE1BQU1HLEVBRVQsV0FBQWpILENBQVkwQyxHQUVSdkMsS0FBSzBDLFVBQVlILEVBRWpCdkMsS0FBSytHLFFBQVUsSUFBSUMsRUFBT2hILEtBQUtpSCxRQUFRbkIsS0FBSzlGLE9BRTVDQSxLQUFLa0gsU0FBVyxHQUVoQmxILEtBQUttSCxPQUFTLElBQ2RuSCxLQUFLb0gsTUFBUSxDQUNyQixDQUVJLE1BQUFDLEdBQ0lySCxLQUFLK0csUUFBUU0sUUFDckIsQ0FFSSxLQUFBQyxHQUNJdEgsS0FBSytHLFFBQVFPLE9BQ3JCLENBRUksT0FBQUwsR0FDSSxNQUFNTSxFQUFNYixFQUFNSCxNQUNsQnZHLEtBQUswQyxVQUFVb0IsSUFBSSxVQUFVMEQsTUFBSyxFQUFFQyxLQUFJckcsV0FDcEMsR0FBSXFHLEVBQUksQ0FDSixNQUFNQyxFQUFNaEIsRUFBTUgsTUFDbEJ2RyxLQUFLMkgsWUFBWUosRUFBS25HLEVBQU1zRyxFQUM1QyxJQUVBLENBRUksV0FBQUMsQ0FBWUMsRUFBSUMsRUFBSUMsR0FDaEIsSUFBSUMsR0FBU0QsRUFBS0YsR0FBTSxFQUNwQkksRUFBT0gsR0FBTUMsRUFBS0YsR0FBTSxFQUN4QkssRUFBUyxDQUFDTCxFQUFJQyxFQUFJQyxFQUFJQyxFQUFPQyxHQUVqQ2hJLEtBQUtrSCxTQUFTN0UsS0FBSzRGLEdBQ2ZqSSxLQUFLa0gsU0FBU3hDLE9BeENELElBMENiMUUsS0FBS2tILFNBQVNnQixRQUdsQkgsRUFBUSxJQUNSQyxFQUFPLEVBQ1AsSUFBSyxNQUFNQyxLQUFVakksS0FBS2tILFNBQ2xCZSxFQUFPLEdBQUtGLElBQ1pBLEVBQVFFLEVBQU8sR0FDZkQsRUFBT0MsRUFBTyxJQUd0QmpJLEtBQUtvSCxNQUFRWSxFQUNiaEksS0FBS21ILE9BQVNZLENBQ3RCLENBRUksUUFBSUMsR0FBUSxPQUFPaEksS0FBS29ILEtBQU0sQ0FDOUIsU0FBSVcsR0FBUyxPQUFPL0gsS0FBS21ILE1BQU8sQ0FFaEMsR0FBQVosR0FFSSxPQUFPRyxFQUFNSCxNQUFRdkcsS0FBS29ILEtBQ2xDLEVBZUEsTUFJTWUsRUFBaUIsSUFDaEIsSUFBSUMsTUFBTSxHQUFHQyxLQUxBLE9BTWIsSUFBSUQsTUFBTSxHQUFHQyxLQUxDLEtBQ0QsS0FRcEIsTUFBTXJCLEVBRUYsV0FBQW5ILENBQWF5SSxHQUNUdEksS0FBS3VJLE9BQVMsRUFDZHZJLEtBQUt3SSxVQUFPekcsRUFDWi9CLEtBQUt5SSxVQUFZSCxFQUNqQnRJLEtBQUswSSxNQUFRMUksS0FBSzJJLEtBQUs3QyxLQUFLOUYsTUFDNUJBLEtBQUs0SSxRQUFVLElBQUlULEVBQzNCLENBQ0ksS0FBQWIsR0FDSXVCLGFBQWE3SSxLQUFLd0ksS0FDMUIsQ0FDSSxNQUFBbkIsR0FDSXdCLGFBQWE3SSxLQUFLd0ksTUFDbEJ4SSxLQUFLMkksTUFDYixDQUNJLE9BQUFHLEdBQ0k5SSxLQUFLNEksUUFBVSxJQUFJVCxHQUNuQlUsYUFBYTdJLEtBQUt3SSxNQUNsQnhJLEtBQUsySSxNQUNiLENBQ0ksSUFBQUEsR0FDSSxJQUFJSSxFQUFhL0ksS0FBSzRJLFFBQVEsR0FDMUI1SSxLQUFLNEksUUFBUWxFLE9BQVMsR0FDdEIxRSxLQUFLNEksUUFBUVYsUUFFYmxJLEtBQUt5SSxXQUNMekksS0FBS3lJLFlBRVR6SSxLQUFLd0ksS0FBTzNHLFdBQVc3QixLQUFLMEksTUFBT0ssRUFDM0MsRUNwSkEsTUFBTUMsRUFBVUMsT0FBT0MsT0FBTyxDQUMxQkMsUUFBVSxVQUNWQyxRQUFTLFVBQ1RDLE1BQU8sVUFHTEMsRUFBU0wsT0FBT0MsT0FBTyxDQUN6QkssSUFBTSxNQUNOQyxJQUFLLE1BQ0xDLE9BQVEsV0NYWixTQUFTQyxFQUFZbkcsR0FDakIsTUFBTUcsR0FBQ0EsRUFBRWlHLElBQUVBLEVBQUd2SSxLQUFFQSxHQUFRbUMsRUFDeEIsSUFBSXFHLEVBQVdDLEtBQUtDLFVBQVUxSSxHQUs5QixNQUFPLDRFQUhPLG9CQUFvQnNDLGVBQ25CLHFCQUZPM0IsTUFBUDRILEVBQW9CRSxLQUFLQyxVQUFVSCxHQUFPLGVBR3pDLHNCQUFzQkMsNEJBTTFDLDJCQUdPLE1BRUgsV0FBQS9KLENBQVlrSyxFQUFZQyxFQUFNakssRUFBUSxDQUFBLEdBQ2xDQyxLQUFLMkYsTUFBUW9FLEVBQ2IvSixLQUFLaUssTUFBUUQsRUFDYmhLLEtBQUs0RixRQUFVNUYsS0FBSzJGLE1BQU1SLGFBQWFuRixLQUFLNkYsVUFBVUMsS0FBSzlGLE9BRzNELElBQUlrSyxFQUFXLENBQ1huRyxRQUFPLEVBQ1BvRyxTQUFTVCxHQUViMUosS0FBS0ssU0FBVyxJQUFJNkosS0FBYW5LLEdBSzdCQyxLQUFLSyxTQUFTMEQsUUFFZGlHLEVBQUtJLGlCQUFpQixTQUFVcEosSUFFNUIsTUFBTXFKLEVBQVlySixFQUFFc0osT0FBT0MsUUFBUSxXQUNuQyxHQUFJRixFQUFXLENBQ1gsTUFBTUcsRUFBV0gsRUFBVUUsUUFBUSxjQUMvQkMsSUFDQXhLLEtBQUsyRixNQUFNbkIsT0FBTyxDQUFDckIsT0FBTyxDQUFDcUgsRUFBUzlHLE1BQ3BDMUMsRUFBRXlKLGtCQUUxQixLQU9RLE1BQU0xRSxFQUFRL0YsS0FBSzJGLE1BQU03QixNQUNwQlcsS0FBSWxCLElBQ00sQ0FBQ0csR0FBR0gsRUFBS0csR0FBSUMsSUFBSUosTUFFaEN2RCxLQUFLNkYsVUFBVUUsRUFDdkIsQ0FFSSxTQUFBRixDQUFVRSxHQUNOLE1BQU1vRSxTQUFDQSxHQUFZbkssS0FBS0ssU0FDeEIsSUFBSyxJQUFJMkQsS0FBUStCLEVBQ2IsR0FBSS9CLEVBQUtMLElBQUssQ0FFVixJQUFJK0csRUFBTzFLLEtBQUtpSyxNQUFNVSxjQUFjLElBQUkzRyxFQUFLTixNQUNqQyxNQUFSZ0gsSUFDQUEsRUFBT0UsU0FBU0MsY0FBYyxPQUM5QkgsRUFBS0ksYUFBYSxLQUFNOUcsRUFBS04sSUFDN0JnSCxFQUFLSyxVQUFVQyxJQUFJLGFBQ25CaEwsS0FBS2lLLE1BQU1nQixZQUFZUCxJQUUzQkEsRUFBS1EsVUFBWWYsRUFBU25HLEVBQUtMLElBQy9DLE1BQW1CLEdBQUlLLEVBQUtKLElBQUssQ0FFakIsSUFBSThHLEVBQU8xSyxLQUFLaUssTUFBTVUsY0FBYyxJQUFJM0csRUFBS04sTUFDekNnSCxHQUNBQSxFQUFLUyxXQUFXQyxZQUFZVixFQUVoRCxDQUVBLHVCRC9ETyxjQUFnQzlLLEVBRW5DLFdBQUFDLENBQWFDLEVBQUtDLEdBQ2RzTCxNQUFNdkwsRUFBS0MsR0FHWEMsS0FBS3NMLE9BQVMsRUFDZHRMLEtBQUt1TCxTQUFXLElBQUl6SSxJQUlwQjlDLEtBQUt3TCxVQUFZLElBQUkxSSxJQUdyQjlDLEtBQUt5TCxVQUFZLElBQUkzSSxJQUdyQjlDLEtBQUswTCxTQUFXLElBQUk1SSxJQUdwQjlDLEtBQUsyTCxjQUVMM0wsS0FBS1UsU0FDYixDQU1JLFVBQUFpQixHQUdJLEdBRkFoQixRQUFRQyxJQUFJLFlBQVlaLEtBQUtGLE9BRXpCRSxLQUFLd0wsVUFBVWxILEtBQU8sRUFBRyxDQUN6QixNQUFNNkIsRUFBUSxJQUFJbkcsS0FBS3dMLFVBQVVJLFdBQ2pDNUwsS0FBS3dFLE9BQU8sUUFBUyxDQUFDcEIsT0FBTytDLEVBQU85QyxPQUFNLEdBQ3RELENBRWtDdEIsTUFBdEIvQixLQUFLMkwsZUFDTDNMLEtBQUsyTCxjQUFjdEUsUUFFL0IsQ0FDSSxhQUFBekYsR0FDSWpCLFFBQVFzQixNQUFNLGNBQWNqQyxLQUFLRixPQUVQaUMsTUFBdEIvQixLQUFLMkwsZUFDTDNMLEtBQUsyTCxjQUFjckUsT0FFL0IsQ0FDSSxRQUFBOUYsQ0FBU1MsR0FDTCxNQUFNRCxNQUFDQSxHQUFNLEdBQVNoQyxLQUFLSyxTQUN2QjJCLEdBQVFyQixRQUFRQyxJQUFJLHdCQUF3QnFCLElBQ3hELENBTUksVUFBQWQsQ0FBV0MsR0FDUCxJQUFJeUssRUFBTWhDLEtBQUtpQyxNQUFNMUssR0FDckIsR0FBSXlLLEVBQUlFLE1BQVEvQyxFQUFRSyxNQUFPLENBQzNCLElBQUkyQyxFQUFRSCxFQUFJSSxPQUNoQixHQUFJak0sS0FBS3VMLFNBQVNoSCxJQUFJeUgsR0FBUSxDQUMxQixJQUFJek0sRUFBV1MsS0FBS3VMLFNBQVN6SCxJQUFJa0ksR0FDakNoTSxLQUFLdUwsU0FBU3hILE9BQU9pSSxHQUNyQixNQUFNdkUsR0FBQ0EsRUFBRXJHLEtBQUVBLEdBQVF5SyxFQUNuQnRNLEVBQVMsQ0FBQ2tJLEtBQUlyRyxRQUM5QixDQUNTLE1BQVV5SyxFQUFJRSxNQUFRL0MsRUFBUUcsU0FDdkIwQyxFQUFJSyxLQUFPNUMsRUFBT0csUUFDbEJ6SixLQUFLbU0sZUFBZU4sRUFHcEMsQ0FFSSxjQUFBTSxDQUFlTixHQUVYLE1BQU1PLEVBQUtwTSxLQUFLeUwsVUFBVTNILElBQUkrSCxFQUFVLE1BQzlCOUosTUFBTnFLLEdBQ0FBLEVBQUdwSixpQkFBaUI2SSxFQUFVLEtBRTFDLENBTUksUUFBQVEsQ0FBU0gsRUFBSzFKLEVBQU04SixHQUNoQixNQUFNTixFQUFRaE0sS0FBS3NMLFNBQ2JPLEVBQU0sQ0FDUkUsS0FBTS9DLEVBQVFJLFFBQ2Q4QyxNQUNBMUosT0FDQThKLE1BQ0FMLE9BQVFELEdBRVpoTSxLQUFLa0MsS0FBSzJILEtBQUtDLFVBQVUrQixJQUN6QixJQUFLekosRUFBUzdDLEdBQVlELElBRTFCLE9BREFVLEtBQUt1TCxTQUFTOUgsSUFBSXVJLEVBQU96TSxHQUNsQjZDLEVBQVFvRixNQUFLLEVBQUVDLEtBQUlyRyxXQUVsQjhLLEdBQU81QyxFQUFPRSxLQUFlLFNBQVJoSCxHQUFtQmlGLElBRXhDekgsS0FBS3dMLFVBQVksSUFBSTFJLElBQUkxQixJQUV0QixDQUFDcUcsS0FBSWpGLE9BQU1wQixVQUU5QixDQUVJLElBQUFtTCxDQUFNL0osR0FDRixHQUFJeEMsS0FBS1MsVUFBVyxDQUVDLElBQUlxQyxJQUFJLElBQUk5QyxLQUFLd0wsWUFFekIvSCxJQUFJakIsRUFBTSxJQUVuQixNQUFNMkQsRUFBUSxJQUFJbkcsS0FBS3dMLFVBQVVJLFdBQ2pDLE9BQU81TCxLQUFLd0UsT0FBTyxRQUFTLENBQUNwQixPQUFPK0MsRUFBTzlDLE9BQU0sR0FDN0QsQ0FHWSxPQURBckQsS0FBS3dMLFVBQVUvSCxJQUFJakIsRUFBTSxDQUFBLEdBQ2xCaEQsUUFBUUMsUUFBUSxDQUFDZ0ksSUFBSSxFQUFNakYsT0FBTXBCLFVBQUtXLEdBR3pELENBRUksTUFBQXlLLENBQVFoSyxHQUVKLE1BQU1pSyxFQUFXLElBQUkzSixJQUFJLElBQUk5QyxLQUFLd0wsWUFFbENpQixFQUFTMUksT0FBT3ZCLEdBRWhCLE1BQU0yRCxFQUFRLElBQUlzRyxFQUFTYixXQUMzQixPQUFPNUwsS0FBS3dFLE9BQU8sUUFBUyxDQUFDcEIsT0FBTytDLEVBQU85QyxPQUFNLEdBQ3pELENBT0ksU0FBSXFKLEdBT0EsT0FOMEIzSyxNQUF0Qi9CLEtBQUsyTCxnQkFDTDNMLEtBQUsyTCxjQUFnQixJQUFJN0UsRUFBWTlHLE1BQ2pDQSxLQUFLUyxXQUNMVCxLQUFLMkwsY0FBY3RFLFVBR3BCckgsS0FBSzJMLGFBQ3BCLENBR0ksR0FBQTdILENBQUl0QixHQUNBLE9BQU94QyxLQUFLcU0sU0FBUy9DLEVBQU9DLElBQUsvRyxFQUN6QyxDQUdJLE1BQUFnQyxDQUFPaEMsRUFBTVMsR0FDVCxPQUFPakQsS0FBS3FNLFNBQVMvQyxFQUFPRSxJQUFLaEgsRUFBTVMsRUFDL0MsQ0FNSSxrQkFBQTBKLENBQW9CbkssRUFBTXpDLEdBV3RCLE9BVkF5QyxFQUFPQSxFQUFLb0ssV0FBVyxLQUFPcEssRUFBTyxJQUFNQSxFQUV0Q3hDLEtBQUt3TCxVQUFVakgsSUFBSS9CLElBRXBCeEMsS0FBS3VNLEtBQUsvSixHQUdUeEMsS0FBS3lMLFVBQVVsSCxJQUFJL0IsSUFDcEJ4QyxLQUFLeUwsVUFBVWhJLElBQUlqQixFQUFNLElBQUlGLEVBQWdCdEMsS0FBTXdDLEVBQU16QyxJQUV0REMsS0FBS3lMLFVBQVUzSCxJQUFJdEIsRUFDbEMsQ0FNSSxjQUFBcUssQ0FBZ0JySyxFQUFNc0ssRUFBTS9NLEdBQ3hCeUMsRUFBT0EsRUFBS29LLFdBQVcsS0FBT3BLLEVBQU8sSUFBTUEsRUFDM0MsTUFBTTRKLEVBQUtwTSxLQUFLMk0sbUJBQW1CbkssR0FFOUJ4QyxLQUFLMEwsU0FBU25ILElBQUkvQixJQUNuQnhDLEtBQUswTCxTQUFTakksSUFBSWpCLEVBQU0sSUFBSU0sS0FFaEMsTUFBTWlLLEVBQVUvTSxLQUFLMEwsU0FBUzVILElBQUl0QixHQUlsQyxPQUhLdUssRUFBUWpKLElBQUlnSixJQUNiQyxFQUFRdEosSUFBSXFKLEVBQU0sSUFBSXRILEVBQVk0RyxFQUFJVSxFQUFNL00sSUFFekNnTixFQUFRakosSUFBSWdKLEVBQzNCLENBS0ksT0FBQUUsQ0FBUXhLLEdBRUF4QyxLQUFLd0wsVUFBVWpILElBQUkvQixJQUNuQnhDLEtBQUt3TSxPQUFPaEssR0FHTHhDLEtBQUt5TCxVQUFVM0gsSUFBSXRCLEdBQzNCTyxzQkFDSCxNQUFNZ0ssRUFBVS9NLEtBQUswTCxTQUFTNUgsSUFBSXRCLEdBQ2xDLEdBQWVULE1BQVhnTCxFQUNBLElBQUssTUFBTUUsS0FBS0YsRUFBUXZKLFNBQ3BCeUosRUFBRWxLLHNCQUdWL0MsS0FBS3lMLFVBQVUxSCxPQUFPdkIsR0FDdEJ4QyxLQUFLMEwsU0FBUzNILE9BQU92QixFQUM3QiJ9
