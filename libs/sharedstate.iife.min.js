var SHAREDSTATE=function(t){"use strict";function e(){let t;return[new Promise(((e,s)=>{t=e})),t]}const s=4;class n{constructor(t,e={}){this._url=t,this._ws,this._connecting=!1,this._connected=!1,this._options=e,this._retries=0,this._connect_promise_resolvers=[]}get connecting(){return this._connecting}get connected(){return this._connected}get url(){return this._url}get options(){return this._options}connect(){this.connecting||this.connected?console.log("Connect while connecting or connected"):this._is_terminated()?console.log("Terminated"):(this._ws=new WebSocket(this._url),this._connecting=!0,this._ws.onopen=t=>this._on_open(t),this._ws.onmessage=t=>this.on_message(t.data),this._ws.onclose=t=>this._on_close(t),this._ws.onerror=t=>this.on_error(t),this.on_connecting())}_on_open(t){this._connecting=!1,this._connected=!0;for(const t of this._connect_promise_resolvers)t();this._connect_promise_resolvers=[],this._retries=0,this.on_connect()}_on_close(t){this._connecting=!1,this._connected=!1,this.on_disconnect(t),this._retries+=1,this._is_terminated()||setTimeout((()=>{this.connect()}),1e3*this._retries)}_is_terminated(){const{retries:t=s}=this._options;return this._retries>=t&&(console.log(`Terminated: Max retries reached (${t})`),this._connecting=!1,this._connected=!0,this._ws.onopen=void 0,this._ws.onmessage=void 0,this._ws.onclose=void 0,this._ws.onerror=void 0,this._ws=void 0,!0)}on_connecting(){const{debug:t=!1}=this._options;t&&console.log(`Connecting ${this.url}`)}on_connect(){console.log(`Connect  ${this.url}`)}on_error(t){const{debug:e=!1}=this._options;e&&console.log(`Error: ${t}`)}on_disconnect(t){console.error(`Disconnect ${this.url}`)}on_message(t){const{debug:e=!1}=this._options;e&&console.log(`Receive: ${t}`)}send(t){if(this._connected)try{this._ws.send(t)}catch(t){console.error(`Send fail: ${t}`)}else console.log("Send drop : not connected")}connectedPromise(){const[t,s]=e();return this.connected?s():this._connect_promise_resolvers.push(s),t}}class i{constructor(t,e,s={}){this._options=s,this._terminated=!1,this._ssclient=t,this._path=e,this._handlers=[],this._map=new Map}_ssclient_terminate(){this._terminated=!0,this._handlers=[]}_ssclient_update(t={}){if(this._terminated)throw new Error("collection already terminated");const{remove:e,insert:s,reset:n=!1}=t,i=new Map;if(n){for(const t of this._map.values())i.set(t.id,{id:t.id,new:void 0,old:t});this._map=new Map}else for(const t of e){const e=this._map.get(t);null!=e&&(this._map.delete(t),i.set(t,{id:t,new:void 0,old:e}))}for(const t of s){const e=t.id,s=i.get(e),n=null!=s?s.old:this._map.get(e);this._map.set(e,t),i.set(e,{id:e,new:t,old:n})}this._notify_callbacks([...i.values()])}_notify_callbacks(t){this._handlers.forEach((function(e){e.handler(t)}))}get size(){return this._map.size}has(t){return this._map.has(t)}get(t){return null==t?[...this._map.values()]:this._map.get(t)}update(t={}){if(this._terminated)throw new Error("collection already terminated");const{insert:e=[]}=t;return t.insert=e.map((t=>(t.id=t.id||function(t){for(var e="",s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",n=0;n<t;n++)e+=s.charAt(Math.floor(52*Math.random()));return e}(10),t))),this._ssclient.update(this._path,t)}add_callback(t){const e={handler:t};return this._handlers.push(e),e}remove_callback(t){const e=this._handlers.indexOf(t);e>-1&&this._handlers.splice(e,1)}}class o{constructor(t,e,s={}){this._terminiated=!1,this._coll=t,this._id=e,this._options=s,this._handlers=[],this._handle=this._coll.add_callback(this._onchange.bind(this))}_onchange(t){if(this._terminated)throw new Error("variable terminated");for(const e of t)e.id==this._id&&this.notify_callbacks(e)}add_callback(t){const e={handler:t};return this._handlers.push(e),e}remove_callback(t){let e=this._handlers.indexOf(t);e>-1&&this._handers.splice(e,1)}notify_callbacks(t){this._handlers.forEach((function(e){e.handler(t)}))}set(t){if(this._terminated)throw new Error("varible terminated");const e=[{id:this._id,data:t}];return this._coll.update({insert:e,reset:!1})}get(){return this._coll.has(this._id)?this._coll.get(this._id).data:this._options.value}ss_client_terminate(){this._terminated=!0,this._coll.remove_callback(this._handle)}}const r=function(){return performance.now()/1e3},c=function(){return new Date/1e3},_=function(){const t=r(),e=c();return{now:function(){const s=r();return e+(s-t)}}}();class h{constructor(t){this._ssclient=t,this._pinger=new l(this._onping.bind(this)),this._samples=[],this._trans=1e3,this._skew=0}resume(){this._pinger.resume()}pause(){this._pinger.pause()}_onping(){const t=_.now();this._ssclient.get("/clock").then((({ok:e,data:s})=>{if(e){const e=_.now();this._add_sample(t,s,e)}}))}_add_sample(t,e,s){let n=(s-t)/2,i=e-(s+t)/2,o=[t,e,s,n,i];this._samples.push(o),this._samples.length>30&&this._samples.shift(),n=1e5,i=0;for(const t of this._samples)t[3]<n&&(n=t[3],i=t[4]);this._skew=i,this._trans=n}get skew(){return this._skew}get trans(){return this._trans}now(){return _.now()+this._skew}}const a=[...new Array(3).fill(20),...new Array(7).fill(500),1e4];class l{constructor(t){this._count=0,this._tid=void 0,this._callback=t,this._ping=this.ping.bind(this),this._delays=[...a]}pause(){clearTimeout(this._tid)}resume(){clearTimeout(this._tid),this.ping()}restart(){this._delays=[...a],clearTimeout(this._tid),this.ping()}ping(){let t=this._delays[0];this._delays.length>1&&this._delays.shift(),this._callback&&this._callback(),this._tid=setTimeout(this._ping,t)}}const d=Object.freeze({MESSAGE:"MESSAGE",REQUEST:"REQUEST",REPLY:"REPLY"}),u=Object.freeze({GET:"GET",PUT:"PUT",NOTIFY:"NOTIFY"});function p(t){const{id:e,itv:s,data:n}=t;let i=JSON.stringify(n);return`\n        <div>\n            <button id="delete">X</button>\n            ${`<span class="id">${e}</span>`}: ${`<span class="itv">${null!=s?JSON.stringify(s):""}</span>`} ${`<span class="data">${i}</span>`}\n        </div>`}return t.CollectionViewer=class{constructor(t,e,s={}){this._coll=t,this._elem=e,this._handle=this._coll.add_callback(this._onchange.bind(this));let n={delete:!1,toString:p};this._options={...n,...s},this._options.delete&&e.addEventListener("click",(t=>{const e=t.target.closest("#delete");if(e){const s=e.closest(".list-item");s&&(this._coll.update({remove:[s.id]}),t.stopPropagation())}}));const i=this._coll.get().map((t=>({id:t.id,new:t})));this._onchange(i)}_onchange(t){const{toString:e}=this._options;for(let s of t)if(s.new){let t=this._elem.querySelector(`#${s.id}`);null==t&&(t=document.createElement("div"),t.setAttribute("id",s.id),t.classList.add("list-item"),this._elem.appendChild(t)),t.innerHTML=e(s.new)}else if(s.old){let t=this._elem.querySelector(`#${s.id}`);t&&t.parentNode.removeChild(t)}}},t.SharedStateClient=class extends n{constructor(t,e){super(t,e),this._reqid=0,this._pending=new Map,this._subs_map=new Map,this._coll_map=new Map,this._var_map=new Map,this._server_clock,this.connect()}on_connect(){if(console.log(`Connect  ${this.url}`),this._subs_map.size>0){const t=[...this._subs_map.entries()];this.update("/subs",{insert:t,reset:!0})}null!=this._server_clock&&this._server_clock.resume()}on_disconnect(){console.error(`Disconnect ${this.url}`),null!=this._server_clock&&this._server_clock.pause()}on_error(t){const{debug:e=!1}=this._options;e&&console.log(`Communication Error: ${t}`)}on_message(t){let e=JSON.parse(t);if(e.type==d.REPLY){let t=e.tunnel;if(this._pending.has(t)){let s=this._pending.get(t);this._pending.delete(t);const{ok:n,data:i}=e;s({ok:n,data:i})}}else e.type==d.MESSAGE&&e.cmd==u.NOTIFY&&this._handle_notify(e)}_handle_notify(t){const e=this._coll_map.get(t.path);null!=e&&e._ssclient_update(t.data)}_request(t,s,n){const i=this._reqid++,o={type:d.REQUEST,cmd:t,path:s,arg:n,tunnel:i};this.send(JSON.stringify(o));let[r,c]=e();return this._pending.set(i,c),r.then((({ok:e,data:n})=>(t==u.PUT&&"/subs"==s&&e&&(this._subs_map=new Map(n)),{ok:e,path:s,data:n})))}_sub(t){if(this.connected){new Map([...this._subs_map]).set(t,{});const e=[...this._subs_map.entries()];return this.update("/subs",{insert:e,reset:!0})}return this._subs_map.set(t,{}),Promise.resolve({ok:!0,path:t,data:void 0})}_unsub(t){const e=new Map([...this._subs_map]);e.delete(t);const s=[...e.entries()];return this.update("/subs",{insert:s,reset:!0})}get clock(){return null==this._server_clock&&(this._server_clock=new h(this),this.connected&&this._server_clock.resume()),this._server_clock}get(t){return this._request(u.GET,t)}update(t,e){return this._request(u.PUT,t,e)}acquire_collection(t,e){return t=t.startsWith("/")?t:"/"+t,this._subs_map.has(t)||this._sub(t),this._coll_map.has(t)||this._coll_map.set(t,new i(this,t,e)),this._coll_map.get(t)}acquire_variable(t,e,s){t=t.startsWith("/")?t:"/"+t;const n=this.acquire_collection(t);this._var_map.has(t)||this._var_map.set(t,new Map);const i=this._var_map.get(t);return i.get(e)||i.set(e,new o(n,e,s)),i.get(e)}release(t){this._subs_map.has(t)&&this._unsub(t);this._coll_map.get(t)._ssclient_terminate();const e=this._var_map.get(t);if(null!=e)for(const t of e.values())t._ssclient_terminate();this._coll_map.delete(t),this._var_map.delete(t)}},t}({});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2hhcmVkc3RhdGUuaWlmZS5taW4uanMiLCJzb3VyY2VzIjpbIi4uLy4uL2NsaWVudC91dGlsLmpzIiwiLi4vLi4vY2xpZW50L3dzaW8uanMiLCIuLi8uLi9jbGllbnQvY29sbGVjdGlvbi5qcyIsIi4uLy4uL2NsaWVudC92YXJpYWJsZS5qcyIsIi4uLy4uL2NsaWVudC9zZXJ2ZXJjbG9jay5qcyIsIi4uLy4uL2NsaWVudC9zc19jbGllbnQuanMiLCIuLi8uLi9jbGllbnQvdmlld2VyLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qXG4gICAgQ3JlYXRlIGEgcHJvbWlzZSB3aGljaCBjYW4gYmUgcmVzb2x2ZWRcbiAgICBwcm9ncmFtbWF0aWNhbGx5IGJ5IGV4dGVybmFsIGNvZGUuXG4gICAgUmV0dXJuIGEgcHJvbWlzZSBhbmQgYSByZXNvbHZlIGZ1bmN0aW9uXG4qL1xuXG5leHBvcnQgZnVuY3Rpb24gcmVzb2x2YWJsZVByb21pc2UoKSB7XG4gICAgbGV0IHJlc29sdmVyO1xuICAgIGxldCBwcm9taXNlID0gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICByZXNvbHZlciA9IHJlc29sdmU7XG4gICAgfSk7XG4gICAgcmV0dXJuIFtwcm9taXNlLCByZXNvbHZlcl07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB0aW1lb3V0UHJvbWlzZSAobXMpIHtcbiAgICBsZXQgcmVzb2x2ZXI7XG4gICAgbGV0IHByb21pc2UgPSBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgIGxldCB0aWQgPSBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgIHJlc29sdmUodHJ1ZSk7XG4gICAgICAgIH0sIG1zKTtcbiAgICAgICAgcmVzb2x2ZXIgPSAoKSA9PiB7XG4gICAgICAgICAgICBpZiAodGlkKSB7XG4gICAgICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHRpZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXNvbHZlKGZhbHNlKTtcbiAgICAgICAgfVxuICAgIH0pO1xuICAgIHJldHVybiBbcHJvbWlzZSwgcmVzb2x2ZXJdO1xufVxuXG5cbmV4cG9ydCBmdW5jdGlvbiByYW5kb21fc3RyaW5nKGxlbmd0aCkge1xuICAgIHZhciB0ZXh0ID0gXCJcIjtcbiAgICB2YXIgcG9zc2libGUgPSBcIkFCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFlaYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXpcIjtcbiAgICBmb3IodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgICAgdGV4dCArPSBwb3NzaWJsZS5jaGFyQXQoTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogcG9zc2libGUubGVuZ3RoKSk7XG4gICAgfVxuICAgIHJldHVybiB0ZXh0O1xufSIsImltcG9ydCB7IHJlc29sdmFibGVQcm9taXNlIH0gZnJvbSBcIi4vdXRpbC5qc1wiO1xuXG5jb25zdCBNQVhfUkVUUklFUyA9IDQ7XG5cbmV4cG9ydCBjbGFzcyBXZWJTb2NrZXRJTyB7XG5cbiAgICBjb25zdHJ1Y3Rvcih1cmwsIG9wdGlvbnM9e30pIHtcbiAgICAgICAgdGhpcy5fdXJsID0gdXJsO1xuICAgICAgICB0aGlzLl93cztcbiAgICAgICAgdGhpcy5fY29ubmVjdGluZyA9IGZhbHNlO1xuICAgICAgICB0aGlzLl9jb25uZWN0ZWQgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5fb3B0aW9ucyA9IG9wdGlvbnM7XG4gICAgICAgIHRoaXMuX3JldHJpZXMgPSAwO1xuICAgICAgICB0aGlzLl9jb25uZWN0X3Byb21pc2VfcmVzb2x2ZXJzID0gW107XG4gICAgfVxuXG4gICAgZ2V0IGNvbm5lY3RpbmcoKSB7cmV0dXJuIHRoaXMuX2Nvbm5lY3Rpbmc7fVxuICAgIGdldCBjb25uZWN0ZWQoKSB7cmV0dXJuIHRoaXMuX2Nvbm5lY3RlZDt9XG4gICAgZ2V0IHVybCgpIHtyZXR1cm4gdGhpcy5fdXJsO31cbiAgICBnZXQgb3B0aW9ucygpIHtyZXR1cm4gdGhpcy5fb3B0aW9uczt9XG5cbiAgICBjb25uZWN0KCkge1xuXG4gICAgICAgIGlmICh0aGlzLmNvbm5lY3RpbmcgfHwgdGhpcy5jb25uZWN0ZWQpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiQ29ubmVjdCB3aGlsZSBjb25uZWN0aW5nIG9yIGNvbm5lY3RlZFwiKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5faXNfdGVybWluYXRlZCgpKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIlRlcm1pbmF0ZWRcIik7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICAvLyBjb25uZWN0aW5nXG4gICAgICAgIHRoaXMuX3dzID0gbmV3IFdlYlNvY2tldCh0aGlzLl91cmwpO1xuICAgICAgICB0aGlzLl9jb25uZWN0aW5nID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5fd3Mub25vcGVuID0gZSA9PiB0aGlzLl9vbl9vcGVuKGUpO1xuICAgICAgICB0aGlzLl93cy5vbm1lc3NhZ2UgPSBlID0+IHRoaXMub25fbWVzc2FnZShlLmRhdGEpO1xuICAgICAgICB0aGlzLl93cy5vbmNsb3NlID0gZSA9PiB0aGlzLl9vbl9jbG9zZShlKTtcbiAgICAgICAgdGhpcy5fd3Mub25lcnJvciA9IGUgPT4gdGhpcy5vbl9lcnJvcihlKTtcbiAgICAgICAgdGhpcy5vbl9jb25uZWN0aW5nKCk7XG4gICAgfVxuXG4gICAgX29uX29wZW4oZXZlbnQpIHtcbiAgICAgICAgdGhpcy5fY29ubmVjdGluZyA9IGZhbHNlO1xuICAgICAgICB0aGlzLl9jb25uZWN0ZWQgPSB0cnVlO1xuICAgICAgICAvLyByZWxlYXNlIGNvbm5lY3QgcHJvbWlzZXNcbiAgICAgICAgZm9yIChjb25zdCByZXNvbHZlciBvZiB0aGlzLl9jb25uZWN0X3Byb21pc2VfcmVzb2x2ZXJzKSB7XG4gICAgICAgICAgICByZXNvbHZlcigpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX2Nvbm5lY3RfcHJvbWlzZV9yZXNvbHZlcnMgPSBbXTtcbiAgICAgICAgLy8gcmVzZXQgcmV0cmllcyBvbiBzdWNjZXNzZnVsIGNvbm5lY3Rpb25cbiAgICAgICAgdGhpcy5fcmV0cmllcyA9IDA7XG4gICAgICAgIHRoaXMub25fY29ubmVjdCgpO1xuICAgIH1cblxuICAgIF9vbl9jbG9zZShldmVudCkge1xuICAgICAgICB0aGlzLl9jb25uZWN0aW5nID0gZmFsc2U7XG4gICAgICAgIHRoaXMuX2Nvbm5lY3RlZCA9IGZhbHNlO1xuICAgICAgICB0aGlzLm9uX2Rpc2Nvbm5lY3QoZXZlbnQpO1xuICAgICAgICB0aGlzLl9yZXRyaWVzICs9IDE7XG4gICAgICAgIGlmICghdGhpcy5faXNfdGVybWluYXRlZCgpKSB7XG4gICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmNvbm5lY3QoKTtcbiAgICAgICAgICAgIH0sIDEwMDAgKiB0aGlzLl9yZXRyaWVzKTtcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBfaXNfdGVybWluYXRlZCgpIHtcbiAgICAgICAgY29uc3Qge3JldHJpZXM9TUFYX1JFVFJJRVN9ID0gdGhpcy5fb3B0aW9ucztcbiAgICAgICAgaWYgKHRoaXMuX3JldHJpZXMgPj0gcmV0cmllcykge1xuICAgICAgICAgICAgY29uc29sZS5sb2coYFRlcm1pbmF0ZWQ6IE1heCByZXRyaWVzIHJlYWNoZWQgKCR7cmV0cmllc30pYCk7XG4gICAgICAgICAgICB0aGlzLl9jb25uZWN0aW5nID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLl9jb25uZWN0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgdGhpcy5fd3Mub25vcGVuID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgdGhpcy5fd3Mub25tZXNzYWdlID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgdGhpcy5fd3Mub25jbG9zZSA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgIHRoaXMuX3dzLm9uZXJyb3IgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICB0aGlzLl93cyA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICBvbl9jb25uZWN0aW5nKCkge1xuICAgICAgICBjb25zdCB7ZGVidWc9ZmFsc2V9ID0gdGhpcy5fb3B0aW9ucztcbiAgICAgICAgaWYgKGRlYnVnKSB7Y29uc29sZS5sb2coYENvbm5lY3RpbmcgJHt0aGlzLnVybH1gKTt9XG4gICAgfVxuICAgIG9uX2Nvbm5lY3QoKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKGBDb25uZWN0ICAke3RoaXMudXJsfWApO1xuICAgIH1cbiAgICBvbl9lcnJvcihlcnJvcikge1xuICAgICAgICBjb25zdCB7ZGVidWc9ZmFsc2V9ID0gdGhpcy5fb3B0aW9ucztcbiAgICAgICAgaWYgKGRlYnVnKSB7Y29uc29sZS5sb2coYEVycm9yOiAke2Vycm9yfWApO31cbiAgICB9XG4gICAgb25fZGlzY29ubmVjdChldmVudCkge1xuICAgICAgICBjb25zb2xlLmVycm9yKGBEaXNjb25uZWN0ICR7dGhpcy51cmx9YCk7XG4gICAgfVxuICAgIG9uX21lc3NhZ2UoZGF0YSkge1xuICAgICAgICBjb25zdCB7ZGVidWc9ZmFsc2V9ID0gdGhpcy5fb3B0aW9ucztcbiAgICAgICAgaWYgKGRlYnVnKSB7Y29uc29sZS5sb2coYFJlY2VpdmU6ICR7ZGF0YX1gKTt9XG4gICAgfVxuXG4gICAgc2VuZChkYXRhKSB7XG4gICAgICAgIGlmICh0aGlzLl9jb25uZWN0ZWQpIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fd3Muc2VuZChkYXRhKTtcbiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihgU2VuZCBmYWlsOiAke2Vycm9yfWApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc29sZS5sb2coYFNlbmQgZHJvcCA6IG5vdCBjb25uZWN0ZWRgKVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgY29ubmVjdGVkUHJvbWlzZSgpIHtcbiAgICAgICAgY29uc3QgW3Byb21pc2UsIHJlc29sdmVyXSA9IHJlc29sdmFibGVQcm9taXNlKCk7XG4gICAgICAgIGlmICh0aGlzLmNvbm5lY3RlZCkge1xuICAgICAgICAgICAgcmVzb2x2ZXIoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuX2Nvbm5lY3RfcHJvbWlzZV9yZXNvbHZlcnMucHVzaChyZXNvbHZlcik7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHByb21pc2U7XG4gICAgfVxufVxuXG5cbiIsImltcG9ydCB7IHJhbmRvbV9zdHJpbmcgfSBmcm9tIFwiLi91dGlsLmpzXCI7XG5cbmV4cG9ydCBjbGFzcyBDb2xsZWN0aW9uIHtcblxuICAgIGNvbnN0cnVjdG9yKHNzY2xpZW50LCBwYXRoLCBvcHRpb25zPXt9KSB7XG4gICAgICAgIHRoaXMuX29wdGlvbnMgPSBvcHRpb25zO1xuICAgICAgICB0aGlzLl90ZXJtaW5hdGVkID0gZmFsc2U7XG4gICAgICAgIC8vIHNoYXJlZHN0YXRlIGNsaWVudFxuICAgICAgICB0aGlzLl9zc2NsaWVudCA9IHNzY2xpZW50O1xuICAgICAgICB0aGlzLl9wYXRoID0gcGF0aDtcbiAgICAgICAgLy8gY2FsbGJhY2tzXG4gICAgICAgIHRoaXMuX2hhbmRsZXJzID0gW107XG4gICAgICAgIC8vIGl0ZW1zXG4gICAgICAgIHRoaXMuX21hcCA9IG5ldyBNYXAoKTtcbiAgICB9XG5cbiAgICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4gICAgICAgIFNIQVJFRCBTVEFURSBDTElFTlQgQVBJXG4gICAgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cblxuICAgIC8qKlxuICAgICAqIENvbGxlY3Rpb24gcmVsZWFzZWQgYnkgc3MgY2xpZW50XG4gICAgICovXG5cbiAgICBfc3NjbGllbnRfdGVybWluYXRlKCkge1xuICAgICAgICB0aGlzLl90ZXJtaW5hdGVkID0gdHJ1ZTtcbiAgICAgICAgLy8gZW1wdHkgY29sbGVjdGlvbj9cbiAgICAgICAgLy8gZGlzY29ubmVjdCBmcm9tIG9ic2VydmVyc1xuICAgICAgICB0aGlzLl9oYW5kbGVycyA9IFtdO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIHNlcnZlciB1cGRhdGUgY29sbGVjdGlvbiBcbiAgICAgKi9cbiAgICBfc3NjbGllbnRfdXBkYXRlIChjaGFuZ2VzPXt9KSB7XG5cbiAgICAgICAgaWYgKHRoaXMuX3Rlcm1pbmF0ZWQpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcImNvbGxlY3Rpb24gYWxyZWFkeSB0ZXJtaW5hdGVkXCIpXG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCB7cmVtb3ZlLCBpbnNlcnQsIHJlc2V0PWZhbHNlfSA9IGNoYW5nZXM7XG4gICAgICAgIGNvbnN0IGRpZmZfbWFwID0gbmV3IE1hcCgpO1xuXG4gICAgICAgIC8vIHJlbW92ZSBpdGVtcyAtIGNyZWF0ZSBkaWZmXG4gICAgICAgIGlmIChyZXNldCkge1xuICAgICAgICAgICAgZm9yIChjb25zdCBpdGVtIG9mIHRoaXMuX21hcC52YWx1ZXMoKSkge1xuICAgICAgICAgICAgICAgIGRpZmZfbWFwLnNldChcbiAgICAgICAgICAgICAgICAgICAgaXRlbS5pZCwgXG4gICAgICAgICAgICAgICAgICAgIHtpZDogaXRlbS5pZCwgbmV3OnVuZGVmaW5lZCwgb2xkOml0ZW19XG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuX21hcCA9IG5ldyBNYXAoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGZvciAoY29uc3QgX2lkIG9mIHJlbW92ZSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IG9sZCA9IHRoaXMuX21hcC5nZXQoX2lkKTtcbiAgICAgICAgICAgICAgICBpZiAob2xkICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9tYXAuZGVsZXRlKF9pZCk7XG4gICAgICAgICAgICAgICAgICAgIGRpZmZfbWFwLnNldChfaWQsIHtpZDpfaWQsIG5ldzp1bmRlZmluZWQsIG9sZH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGluc2VydCBpdGVtcyAtIHVwZGF0ZSBkaWZmXG4gICAgICAgIGZvciAoY29uc3QgaXRlbSBvZiBpbnNlcnQpIHtcbiAgICAgICAgICAgIGNvbnN0IF9pZCA9IGl0ZW0uaWQ7XG4gICAgICAgICAgICAvLyBvbGQgZnJvbSBkaWZmX21hcCBvciBfbWFwXG4gICAgICAgICAgICBjb25zdCBkaWZmID0gZGlmZl9tYXAuZ2V0KF9pZCk7XG4gICAgICAgICAgICBjb25zdCBvbGQgPSAoZGlmZiAhPSB1bmRlZmluZWQpID8gZGlmZi5vbGQgOiB0aGlzLl9tYXAuZ2V0KF9pZCk7XG4gICAgICAgICAgICAvLyBzZXQgc3RhdGVcbiAgICAgICAgICAgIHRoaXMuX21hcC5zZXQoX2lkLCBpdGVtKTtcbiAgICAgICAgICAgIC8vIHVwZGF0ZSBkaWZmIG1hcFxuICAgICAgICAgICAgZGlmZl9tYXAuc2V0KF9pZCwge2lkOl9pZCwgbmV3Oml0ZW0sIG9sZH0pO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX25vdGlmeV9jYWxsYmFja3MoWy4uLmRpZmZfbWFwLnZhbHVlcygpXSk7XG4gICAgfVxuXG4gICAgX25vdGlmeV9jYWxsYmFja3MgKGVBcmcpIHtcbiAgICAgICAgdGhpcy5faGFuZGxlcnMuZm9yRWFjaChmdW5jdGlvbihoYW5kbGUpIHtcbiAgICAgICAgICAgIGhhbmRsZS5oYW5kbGVyKGVBcmcpO1xuICAgICAgICB9KTtcbiAgICB9O1xuXG4gICAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuICAgICAgICBBUFBMSUNBVElPTiBBUElcbiAgICAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuXG4gICAgZ2V0IHNpemUoKSB7cmV0dXJuIHRoaXMuX21hcC5zaXplfVxuICAgIGhhcyhpZCkge3JldHVybiB0aGlzLl9tYXAuaGFzKGlkKX1cbiAgICBnZXQoaWQpIHtcbiAgICAgICAgaWYgKGlkID09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcmV0dXJuIFsuLi50aGlzLl9tYXAudmFsdWVzKCldXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fbWFwLmdldChpZClcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIGFwcGxpY2F0aW9uIGRpc3BhdGNoaW5nIHVwZGF0ZSB0byBzZXJ2ZXJcbiAgICAgKi9cbiAgICB1cGRhdGUgKGNoYW5nZXM9e30pIHtcbiAgICAgICAgaWYgKHRoaXMuX3Rlcm1pbmF0ZWQpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcImNvbGxlY3Rpb24gYWxyZWFkeSB0ZXJtaW5hdGVkXCIpXG4gICAgICAgIH1cbiAgICAgICAgLy8gZW5zdXJlIHRoYXQgaW5zZXJ0ZWQgaXRlbXMgaGF2ZSBpZHNcbiAgICAgICAgY29uc3Qge2luc2VydD1bXX0gPSBjaGFuZ2VzO1xuICAgICAgICBjaGFuZ2VzLmluc2VydCA9IGluc2VydC5tYXAoKGl0ZW0pID0+IHtcbiAgICAgICAgICAgIGl0ZW0uaWQgPSBpdGVtLmlkIHx8IHJhbmRvbV9zdHJpbmcoMTApO1xuICAgICAgICAgICAgcmV0dXJuIGl0ZW07XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gdGhpcy5fc3NjbGllbnQudXBkYXRlKHRoaXMuX3BhdGgsIGNoYW5nZXMpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIGFwcGxpY2F0aW9uIHJlZ2lzdGVyIGNhbGxiYWNrXG4gICAgKi9cbiAgICBhZGRfY2FsbGJhY2sgKGhhbmRsZXIpIHtcbiAgICAgICAgY29uc3QgaGFuZGxlID0ge2hhbmRsZXJ9O1xuICAgICAgICB0aGlzLl9oYW5kbGVycy5wdXNoKGhhbmRsZSk7XG4gICAgICAgIHJldHVybiBoYW5kbGU7XG4gICAgfTsgICAgXG4gICAgcmVtb3ZlX2NhbGxiYWNrIChoYW5kbGUpIHtcbiAgICAgICAgY29uc3QgaW5kZXggPSB0aGlzLl9oYW5kbGVycy5pbmRleE9mKGhhbmRsZSk7XG4gICAgICAgIGlmIChpbmRleCA+IC0xKSB7XG4gICAgICAgICAgICB0aGlzLl9oYW5kbGVycy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICB9XG4gICAgfTsgICAgXG59IiwiXG4vKipcbiAqIFZhcmlhYmxlXG4gKiBcbiAqIFdyYXBwZXIgdG8gZXhwb3NlIGEgc2luZ2xlIGlkIChpdGVtKSBmcm9tIGEgY29sbGVjdGlvbiBhcyBhIHN0YW5kYWxvbmUgdmFyaWFibGVcbiAqIFxuICogLSBpZiB0aGVyZSBpcyBubyBpdGVtIHdpdGggaWQgaW4gY29sbGVjdGlvbiAtIHRoZSB2YXJpYWJsZSB3aWxsIGJlIHVuZGVmaW5lZFxuICogICBvciBoYXZlIGEgZGVmYXVsdCB2YWx1ZVxuICogLSBvdGhlcndpc2UsIHRoZSB2YXJpYWJsZSB3aWxsIGJlIHRoZSB2YWx1ZSBvZiBpdGVtLmRhdGFcbiAqIFxuICogIERlZmF1bHQgdmFsdWUgaXMgZ2l2ZW4gaW4gb3B0aW9ucyB7dmFsdWU6fVxuICovXG5cbmV4cG9ydCBjbGFzcyBWYXJpYWJsZSB7XG5cbiAgICBjb25zdHJ1Y3Rvcihjb2xsLCBpZCwgb3B0aW9ucz17fSkge1xuICAgICAgICB0aGlzLl90ZXJtaW5pYXRlZCA9IGZhbHNlO1xuICAgICAgICB0aGlzLl9jb2xsID0gY29sbDtcbiAgICAgICAgdGhpcy5faWQgPSBpZDtcbiAgICAgICAgdGhpcy5fb3B0aW9ucyA9IG9wdGlvbnM7XG4gICAgICAgIC8vIGNhbGxiYWNrXG4gICAgICAgIHRoaXMuX2hhbmRsZXJzID0gW107XG4gICAgICAgIHRoaXMuX2hhbmRsZSA9IHRoaXMuX2NvbGwuYWRkX2NhbGxiYWNrKHRoaXMuX29uY2hhbmdlLmJpbmQodGhpcykpO1xuICAgIH1cblxuICAgIF9vbmNoYW5nZShkaWZmcykge1xuICAgICAgICBpZiAodGhpcy5fdGVybWluYXRlZCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwidmFyaWFibGUgdGVybWluYXRlZFwiKVxuICAgICAgICB9XG4gICAgICAgIGZvciAoY29uc3QgZGlmZiBvZiBkaWZmcykge1xuICAgICAgICAgICAgaWYgKGRpZmYuaWQgPT0gdGhpcy5faWQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLm5vdGlmeV9jYWxsYmFja3MoZGlmZik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBhZGRfY2FsbGJhY2sgKGhhbmRsZXIpIHtcbiAgICAgICAgY29uc3QgaGFuZGxlID0ge2hhbmRsZXI6IGhhbmRsZXJ9O1xuICAgICAgICB0aGlzLl9oYW5kbGVycy5wdXNoKGhhbmRsZSk7XG4gICAgICAgIHJldHVybiBoYW5kbGU7XG4gICAgfTtcbiAgICBcbiAgICByZW1vdmVfY2FsbGJhY2sgKGhhbmRsZSkge1xuICAgICAgICBsZXQgaW5kZXggPSB0aGlzLl9oYW5kbGVycy5pbmRleE9mKGhhbmRsZSk7XG4gICAgICAgIGlmIChpbmRleCA+IC0xKSB7XG4gICAgICAgICAgICB0aGlzLl9oYW5kZXJzLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFxuICAgIG5vdGlmeV9jYWxsYmFja3MgKGVBcmcpIHtcbiAgICAgICAgdGhpcy5faGFuZGxlcnMuZm9yRWFjaChmdW5jdGlvbihoYW5kbGUpIHtcbiAgICAgICAgICAgIGhhbmRsZS5oYW5kbGVyKGVBcmcpO1xuICAgICAgICB9KTtcbiAgICB9O1xuXG4gICAgXG4gICAgc2V0ICh2YWx1ZSkge1xuICAgICAgICBpZiAodGhpcy5fdGVybWluYXRlZCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwidmFyaWJsZSB0ZXJtaW5hdGVkXCIpXG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgaXRlbXMgPSBbe2lkOnRoaXMuX2lkLCBkYXRhOnZhbHVlfV07XG4gICAgICAgIHJldHVybiB0aGlzLl9jb2xsLnVwZGF0ZSh7aW5zZXJ0Oml0ZW1zLCByZXNldDpmYWxzZX0pO1xuICAgIH1cblxuICAgIGdldCAoKSB7XG4gICAgICAgIGlmICh0aGlzLl9jb2xsLmhhcyh0aGlzLl9pZCkpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9jb2xsLmdldCh0aGlzLl9pZCkuZGF0YTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9vcHRpb25zLnZhbHVlO1xuICAgICAgICB9XG4gICAgfVxuICAgIFxuICAgIHNzX2NsaWVudF90ZXJtaW5hdGUoKSB7XG4gICAgICAgIHRoaXMuX3Rlcm1pbmF0ZWQgPSB0cnVlO1xuICAgICAgICB0aGlzLl9jb2xsLnJlbW92ZV9jYWxsYmFjayh0aGlzLl9oYW5kbGUpO1xuICAgIH1cbn0iLCIvLyB3ZWJwYWdlIGNsb2NrIC0gcGVyZm9ybWFuY2Ugbm93IC0gc2Vjb25kc1xuY29uc3QgbG9jYWwgPSB7XG4gICAgbm93OiBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHBlcmZvcm1hbmNlLm5vdygpLzEwMDAuMDtcbiAgICB9XG59XG4vLyBzeXN0ZW0gY2xvY2sgLSBlcG9jaCAtIHNlY29uZHNcbmNvbnN0IGVwb2NoID0ge1xuICAgIG5vdzogZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBuZXcgRGF0ZSgpLzEwMDAuMDtcbiAgICB9XG59XG5cbi8qKlxuICogQ0xPQ0sgZ2l2ZXMgZXBvY2ggdmFsdWVzLCBidXQgaXMgaW1wbGVtZW50ZWRcbiAqIHVzaW5nIHBlcmZvcm1hbmNlIG5vdyBmb3IgYmV0dGVyXG4gKiB0aW1lIHJlc29sdXRpb24gYW5kIHByb3RlY3Rpb24gYWdhaW5zdCBzeXN0ZW0gXG4gKiB0aW1lIGFkanVzdG1lbnRzLlxuICovXG5cbmNvbnN0IENMT0NLID0gZnVuY3Rpb24gKCkge1xuICAgIGNvbnN0IHQwX2xvY2FsID0gbG9jYWwubm93KCk7XG4gICAgY29uc3QgdDBfZXBvY2ggPSBlcG9jaC5ub3coKTtcbiAgICByZXR1cm4ge1xuICAgICAgICBub3c6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGNvbnN0IHQxX2xvY2FsID0gbG9jYWwubm93KCk7XG4gICAgICAgICAgICByZXR1cm4gdDBfZXBvY2ggKyAodDFfbG9jYWwgLSB0MF9sb2NhbCk7XG4gICAgICAgIH1cbiAgICB9O1xufSgpO1xuXG5cbi8qKlxuICogRXN0aW1hdGUgdGhlIGNsb2NrIG9mIHRoZSBzZXJ2ZXIgXG4gKi9cblxuY29uc3QgTUFYX1NBTVBMRV9DT1VOVCA9IDMwO1xuXG5leHBvcnQgY2xhc3MgU2VydmVyQ2xvY2sge1xuXG4gICAgY29uc3RydWN0b3Ioc3NjbGllbnQpIHtcbiAgICAgICAgLy8gc2hhcmVzdGF0ZSBjbGllbnRcbiAgICAgICAgdGhpcy5fc3NjbGllbnQgPSBzc2NsaWVudDtcbiAgICAgICAgLy8gcGluZ2VyXG4gICAgICAgIHRoaXMuX3BpbmdlciA9IG5ldyBQaW5nZXIodGhpcy5fb25waW5nLmJpbmQodGhpcykpO1xuICAgICAgICAvLyBzYW1wbGVzXG4gICAgICAgIHRoaXMuX3NhbXBsZXMgPSBbXTtcbiAgICAgICAgLy8gZXN0aW1hdGVzXG4gICAgICAgIHRoaXMuX3RyYW5zID0gMTAwMC4wO1xuICAgICAgICB0aGlzLl9za2V3ID0gMC4wO1xuICAgIH1cblxuICAgIHJlc3VtZSgpIHtcbiAgICAgICAgdGhpcy5fcGluZ2VyLnJlc3VtZSgpO1xuICAgIH1cblxuICAgIHBhdXNlKCkge1xuICAgICAgICB0aGlzLl9waW5nZXIucGF1c2UoKTtcbiAgICB9XG5cbiAgICBfb25waW5nKCkge1xuICAgICAgICBjb25zdCB0czAgPSBDTE9DSy5ub3coKTtcbiAgICAgICAgdGhpcy5fc3NjbGllbnQuZ2V0KFwiL2Nsb2NrXCIpLnRoZW4oKHtvaywgZGF0YX0pID0+IHtcbiAgICAgICAgICAgIGlmIChvaykge1xuICAgICAgICAgICAgICAgIGNvbnN0IHRzMSA9IENMT0NLLm5vdygpO1xuICAgICAgICAgICAgICAgIHRoaXMuX2FkZF9zYW1wbGUodHMwLCBkYXRhLCB0czEpOyAgICBcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgX2FkZF9zYW1wbGUoY3MsIHNzLCBjcikge1xuICAgICAgICBsZXQgdHJhbnMgPSAoY3IgLSBjcykgLyAyLjA7XG4gICAgICAgIGxldCBza2V3ID0gc3MgLSAoY3IgKyBjcykgLyAyLjA7XG4gICAgICAgIGxldCBzYW1wbGUgPSBbY3MsIHNzLCBjciwgdHJhbnMsIHNrZXddO1xuICAgICAgICAvLyBhZGQgdG8gc2FtcGxlc1xuICAgICAgICB0aGlzLl9zYW1wbGVzLnB1c2goc2FtcGxlKVxuICAgICAgICBpZiAodGhpcy5fc2FtcGxlcy5sZW5ndGggPiBNQVhfU0FNUExFX0NPVU5UKSB7XG4gICAgICAgICAgICAvLyByZW1vdmUgZmlyc3Qgc2FtcGxlXG4gICAgICAgICAgICB0aGlzLl9zYW1wbGVzLnNoaWZ0KCk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gcmVldmFsdWF0ZSBlc3RpbWF0ZXMgZm9yIHNrZXcgYW5kIHRyYW5zXG4gICAgICAgIHRyYW5zID0gMTAwMDAwLjA7XG4gICAgICAgIHNrZXcgPSAwLjA7XG4gICAgICAgIGZvciAoY29uc3Qgc2FtcGxlIG9mIHRoaXMuX3NhbXBsZXMpIHtcbiAgICAgICAgICAgIGlmIChzYW1wbGVbM10gPCB0cmFucykge1xuICAgICAgICAgICAgICAgIHRyYW5zID0gc2FtcGxlWzNdO1xuICAgICAgICAgICAgICAgIHNrZXcgPSBzYW1wbGVbNF07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fc2tldyA9IHNrZXc7XG4gICAgICAgIHRoaXMuX3RyYW5zID0gdHJhbnM7XG4gICAgfVxuXG4gICAgZ2V0IHNrZXcoKSB7cmV0dXJuIHRoaXMuX3NrZXc7fVxuICAgIGdldCB0cmFucygpIHtyZXR1cm4gdGhpcy5fdHJhbnM7fVxuXG4gICAgbm93KCkge1xuICAgICAgICAvLyBzZXJ2ZXIgY2xvY2sgaXMgbG9jYWwgY2xvY2sgKyBlc3RpbWF0ZWQgc2tld1xuICAgICAgICByZXR1cm4gQ0xPQ0subm93KCkgKyB0aGlzLl9za2V3O1xuICAgIH1cblxufVxuXG5cbi8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiAgICBQSU5HRVJcbioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG5cbi8qKlxuICogUGluZ2VyIGludm9rZXMgYSBjYWxsYmFjayByZXBlYXRlZGx5LCBpbmRlZmluaXRlbHkuIFxuICogUGluZ2luZyBpbiAzIHN0YWdlcywgZmlyc3QgZnJlcXVlbnRseSwgdGhlbiBtb2RlcmF0ZWx5LCBcbiAqIHRoZW4gc2xvd2x5LlxuICovXG5cbmNvbnN0IFNNQUxMX0RFTEFZID0gMjA7IC8vIG1zXG5jb25zdCBNRURJVU1fREVMQVkgPSA1MDA7IC8vIG1zXG5jb25zdCBMQVJHRV9ERUxBWSA9IDEwMDAwOyAvLyBtc1xuXG5jb25zdCBERUxBWV9TRVFVRU5DRSA9IFtcbiAgICAuLi5uZXcgQXJyYXkoMykuZmlsbChTTUFMTF9ERUxBWSksIFxuICAgIC4uLm5ldyBBcnJheSg3KS5maWxsKE1FRElVTV9ERUxBWSksXG4gICAgLi4uW0xBUkdFX0RFTEFZXVxuXTtcblxuY2xhc3MgUGluZ2VyIHtcblxuICAgIGNvbnN0cnVjdG9yIChjYWxsYmFjaykge1xuICAgICAgICB0aGlzLl9jb3VudCA9IDA7XG4gICAgICAgIHRoaXMuX3RpZCA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5fY2FsbGJhY2sgPSBjYWxsYmFjaztcbiAgICAgICAgdGhpcy5fcGluZyA9IHRoaXMucGluZy5iaW5kKHRoaXMpO1xuICAgICAgICB0aGlzLl9kZWxheXMgPSBbLi4uREVMQVlfU0VRVUVOQ0VdO1xuICAgIH1cbiAgICBwYXVzZSgpIHtcbiAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMuX3RpZCk7XG4gICAgfVxuICAgIHJlc3VtZSgpIHtcbiAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMuX3RpZCk7XG4gICAgICAgIHRoaXMucGluZygpO1xuICAgIH1cbiAgICByZXN0YXJ0KCkge1xuICAgICAgICB0aGlzLl9kZWxheXMgPSBbLi4uREVMQVlfU0VRVUVOQ0VdO1xuICAgICAgICBjbGVhclRpbWVvdXQodGhpcy5fdGlkKTtcbiAgICAgICAgdGhpcy5waW5nKCk7XG4gICAgfVxuICAgIHBpbmcgKCkge1xuICAgICAgICBsZXQgbmV4dF9kZWxheSA9IHRoaXMuX2RlbGF5c1swXTtcbiAgICAgICAgaWYgKHRoaXMuX2RlbGF5cy5sZW5ndGggPiAxKSB7XG4gICAgICAgICAgICB0aGlzLl9kZWxheXMuc2hpZnQoKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5fY2FsbGJhY2spIHtcbiAgICAgICAgICAgIHRoaXMuX2NhbGxiYWNrKCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fdGlkID0gc2V0VGltZW91dCh0aGlzLl9waW5nLCBuZXh0X2RlbGF5KTtcbiAgICB9XG59XG5cblxuIiwiaW1wb3J0IHsgV2ViU29ja2V0SU8gfSBmcm9tIFwiLi93c2lvLmpzXCI7XG5pbXBvcnQgeyByZXNvbHZhYmxlUHJvbWlzZSB9IGZyb20gXCIuL3V0aWwuanNcIjtcbmltcG9ydCB7IENvbGxlY3Rpb24gfSBmcm9tIFwiLi9jb2xsZWN0aW9uLmpzXCI7XG5pbXBvcnQgeyBWYXJpYWJsZSB9IGZyb20gXCIuL3ZhcmlhYmxlLmpzXCI7XG5pbXBvcnQgeyBTZXJ2ZXJDbG9jayB9IGZyb20gXCIuL3NlcnZlcmNsb2NrLmpzXCI7XG5cbmNvbnN0IE1zZ1R5cGUgPSBPYmplY3QuZnJlZXplKHtcbiAgICBNRVNTQUdFIDogXCJNRVNTQUdFXCIsXG4gICAgUkVRVUVTVDogXCJSRVFVRVNUXCIsXG4gICAgUkVQTFk6IFwiUkVQTFlcIlxuIH0pO1xuIFxuY29uc3QgTXNnQ21kID0gT2JqZWN0LmZyZWV6ZSh7XG4gICAgR0VUIDogXCJHRVRcIixcbiAgICBQVVQ6IFwiUFVUXCIsXG4gICAgTk9USUZZOiBcIk5PVElGWVwiXG59KTtcblxuXG5leHBvcnQgY2xhc3MgU2hhcmVkU3RhdGVDbGllbnQgZXh0ZW5kcyBXZWJTb2NrZXRJTyB7XG5cbiAgICBjb25zdHJ1Y3RvciAodXJsLCBvcHRpb25zKSB7XG4gICAgICAgIHN1cGVyKHVybCwgb3B0aW9ucyk7XG5cbiAgICAgICAgLy8gcmVxdWVzdHNcbiAgICAgICAgdGhpcy5fcmVxaWQgPSAwO1xuICAgICAgICB0aGlzLl9wZW5kaW5nID0gbmV3IE1hcCgpO1xuXG4gICAgICAgIC8vIHN1YnNjcmlwdGlvbnNcbiAgICAgICAgLy8gcGF0aCAtPiB7fSBcbiAgICAgICAgdGhpcy5fc3Vic19tYXAgPSBuZXcgTWFwKCk7XG5cbiAgICAgICAgLy8gY29sbGVjdGlvbnMge3BhdGggLT4gY29sbGVjdGlvbn1cbiAgICAgICAgdGhpcy5fY29sbF9tYXAgPSBuZXcgTWFwKCk7XG5cbiAgICAgICAgLy8gdmFyaWFibGVzIHtbcGF0aCwgaWRdIC0+IHZhcmlhYmxlfVxuICAgICAgICB0aGlzLl92YXJfbWFwID0gbmV3IE1hcCgpO1xuXG4gICAgICAgIC8vIHNlcnZlciBjbG9ja1xuICAgICAgICB0aGlzLl9zZXJ2ZXJfY2xvY2s7XG5cbiAgICAgICAgdGhpcy5jb25uZWN0KCk7XG4gICAgfVxuXG4gICAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuICAgICAgICBDT05ORUNUSU9OIFxuICAgICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cblxuICAgIG9uX2Nvbm5lY3QoKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKGBDb25uZWN0ICAke3RoaXMudXJsfWApO1xuICAgICAgICAvLyByZWZyZXNoIGxvY2FsIHN1c2NyaXB0aW9uc1xuICAgICAgICBpZiAodGhpcy5fc3Vic19tYXAuc2l6ZSA+IDApIHtcbiAgICAgICAgICAgIGNvbnN0IGl0ZW1zID0gWy4uLnRoaXMuX3N1YnNfbWFwLmVudHJpZXMoKV07XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZShcIi9zdWJzXCIsIHtpbnNlcnQ6aXRlbXMsIHJlc2V0OnRydWV9KTtcbiAgICAgICAgfVxuICAgICAgICAvLyBzZXJ2ZXIgY2xvY2tcbiAgICAgICAgaWYgKHRoaXMuX3NlcnZlcl9jbG9jayAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHRoaXMuX3NlcnZlcl9jbG9jay5yZXN1bWUoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBvbl9kaXNjb25uZWN0KCkge1xuICAgICAgICBjb25zb2xlLmVycm9yKGBEaXNjb25uZWN0ICR7dGhpcy51cmx9YCk7XG4gICAgICAgIC8vIHNlcnZlciBjbG9ja1xuICAgICAgICBpZiAodGhpcy5fc2VydmVyX2Nsb2NrICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdGhpcy5fc2VydmVyX2Nsb2NrLnBhdXNlKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgb25fZXJyb3IoZXJyb3IpIHtcbiAgICAgICAgY29uc3Qge2RlYnVnPWZhbHNlfSA9IHRoaXMuX29wdGlvbnM7XG4gICAgICAgIGlmIChkZWJ1Zykge2NvbnNvbGUubG9nKGBDb21tdW5pY2F0aW9uIEVycm9yOiAke2Vycm9yfWApO31cbiAgICB9XG5cbiAgICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4gICAgICAgIEhBTkRMRVJTXG4gICAgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuXG4gICAgb25fbWVzc2FnZShkYXRhKSB7XG4gICAgICAgIGxldCBtc2cgPSBKU09OLnBhcnNlKGRhdGEpO1xuICAgICAgICBpZiAobXNnLnR5cGUgPT0gTXNnVHlwZS5SRVBMWSkge1xuICAgICAgICAgICAgbGV0IHJlcWlkID0gbXNnLnR1bm5lbDtcbiAgICAgICAgICAgIGlmICh0aGlzLl9wZW5kaW5nLmhhcyhyZXFpZCkpIHtcbiAgICAgICAgICAgICAgICBsZXQgcmVzb2x2ZXIgPSB0aGlzLl9wZW5kaW5nLmdldChyZXFpZCk7XG4gICAgICAgICAgICAgICAgdGhpcy5fcGVuZGluZy5kZWxldGUocmVxaWQpO1xuICAgICAgICAgICAgICAgIGNvbnN0IHtvaywgZGF0YX0gPSBtc2c7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZXIoe29rLCBkYXRhfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAobXNnLnR5cGUgPT0gTXNnVHlwZS5NRVNTQUdFKSB7XG4gICAgICAgICAgICBpZiAobXNnLmNtZCA9PSBNc2dDbWQuTk9USUZZKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5faGFuZGxlX25vdGlmeShtc2cpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgX2hhbmRsZV9ub3RpZnkobXNnKSB7XG4gICAgICAgIC8vIHVwZGF0ZSBjb2xsZWN0aW9uIHN0YXRlXG4gICAgICAgIGNvbnN0IGRzID0gdGhpcy5fY29sbF9tYXAuZ2V0KG1zZ1tcInBhdGhcIl0pO1xuICAgICAgICBpZiAoZHMgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBkcy5fc3NjbGllbnRfdXBkYXRlKG1zZ1tcImRhdGFcIl0pO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuICAgICAgICBTRVJWRVIgUkVRVUVTVFNcbiAgICAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG5cbiAgICBfcmVxdWVzdChjbWQsIHBhdGgsIGFyZykge1xuICAgICAgICBjb25zdCByZXFpZCA9IHRoaXMuX3JlcWlkKys7XG4gICAgICAgIGNvbnN0IG1zZyA9IHtcbiAgICAgICAgICAgIHR5cGU6IE1zZ1R5cGUuUkVRVUVTVCxcbiAgICAgICAgICAgIGNtZCwgXG4gICAgICAgICAgICBwYXRoLCBcbiAgICAgICAgICAgIGFyZyxcbiAgICAgICAgICAgIHR1bm5lbDogcmVxaWRcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5zZW5kKEpTT04uc3RyaW5naWZ5KG1zZykpO1xuICAgICAgICBsZXQgW3Byb21pc2UsIHJlc29sdmVyXSA9IHJlc29sdmFibGVQcm9taXNlKCk7XG4gICAgICAgIHRoaXMuX3BlbmRpbmcuc2V0KHJlcWlkLCByZXNvbHZlcik7XG4gICAgICAgIHJldHVybiBwcm9taXNlLnRoZW4oKHtvaywgZGF0YX0pID0+IHtcbiAgICAgICAgICAgIC8vIHNwZWNpYWwgaGFuZGxpbmcgZm9yIHJlcGxpZXMgdG8gUFVUIC9zdWJzXG4gICAgICAgICAgICBpZiAoY21kID09IE1zZ0NtZC5QVVQgJiYgcGF0aCA9PSBcIi9zdWJzXCIgJiYgb2spIHtcbiAgICAgICAgICAgICAgICAvLyB1cGRhdGUgbG9jYWwgc3Vic2NyaXB0aW9uIHN0YXRlXG4gICAgICAgICAgICAgICAgdGhpcy5fc3Vic19tYXAgPSBuZXcgTWFwKGRhdGEpXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4ge29rLCBwYXRoLCBkYXRhfTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgX3N1YiAocGF0aCkge1xuICAgICAgICBpZiAodGhpcy5jb25uZWN0ZWQpIHtcbiAgICAgICAgICAgIC8vIGNvcHkgY3VycmVudCBzdGF0ZSBvZiBzdWJzXG4gICAgICAgICAgICBjb25zdCBzdWJzX21hcCA9IG5ldyBNYXAoWy4uLnRoaXMuX3N1YnNfbWFwXSk7XG4gICAgICAgICAgICAvLyBzZXQgbmV3IHBhdGhcbiAgICAgICAgICAgIHN1YnNfbWFwLnNldChwYXRoLCB7fSk7XG4gICAgICAgICAgICAvLyByZXNldCBzdWJzIG9uIHNlcnZlclxuICAgICAgICAgICAgY29uc3QgaXRlbXMgPSBbLi4udGhpcy5fc3Vic19tYXAuZW50cmllcygpXTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnVwZGF0ZShcIi9zdWJzXCIsIHtpbnNlcnQ6aXRlbXMsIHJlc2V0OnRydWV9KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIHVwZGF0ZSBsb2NhbCBzdWJzIC0gc3Vic2NyaWJlIG9uIHJlY29ubmVjdFxuICAgICAgICAgICAgdGhpcy5fc3Vic19tYXAuc2V0KHBhdGgsIHt9KTtcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoe29rOiB0cnVlLCBwYXRoLCBkYXRhOnVuZGVmaW5lZH0pXG4gICAgICAgIH1cblxuICAgIH1cblxuICAgIF91bnN1YiAocGF0aCkge1xuICAgICAgICAvLyBjb3B5IGN1cnJlbnQgc3RhdGUgb2Ygc3Vic1xuICAgICAgICBjb25zdCBzdWJzX21hcCA9IG5ldyBNYXAoWy4uLnRoaXMuX3N1YnNfbWFwXSk7XG4gICAgICAgIC8vIHJlbW92ZSBwYXRoXG4gICAgICAgIHN1YnNfbWFwLmRlbGV0ZShwYXRoKVxuICAgICAgICAvLyByZXNldCBzdWJzIG9uIHNlcnZlclxuICAgICAgICBjb25zdCBpdGVtcyA9IFsuLi5zdWJzX21hcC5lbnRyaWVzKCldO1xuICAgICAgICByZXR1cm4gdGhpcy51cGRhdGUoXCIvc3Vic1wiLCB7aW5zZXJ0Oml0ZW1zLCByZXNldDp0cnVlfSk7XG4gICAgfVxuXG4gICAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuICAgICAgICBBUElcbiAgICAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG5cbiAgICAvLyBhY2NzZXNzb3IgZm9yIHNlcnZlciBjbG9ja1xuICAgIGdldCBjbG9jaygpIHtcbiAgICAgICAgaWYgKHRoaXMuX3NlcnZlcl9jbG9jayA9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHRoaXMuX3NlcnZlcl9jbG9jayA9IG5ldyBTZXJ2ZXJDbG9jayh0aGlzKTtcbiAgICAgICAgICAgIGlmICh0aGlzLmNvbm5lY3RlZCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX3NlcnZlcl9jbG9jay5yZXN1bWUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5fc2VydmVyX2Nsb2NrO1xuICAgIH1cblxuICAgIC8vIGdldCByZXF1ZXN0IGZvciBpdGVtcyBieSBwYXRoXG4gICAgZ2V0KHBhdGgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoTXNnQ21kLkdFVCwgcGF0aCk7XG4gICAgfVxuICAgIFxuICAgIC8vIHVwZGF0ZSByZXF1ZXN0IGZvciBwYXRoXG4gICAgdXBkYXRlKHBhdGgsIGNoYW5nZXMpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoTXNnQ21kLlBVVCwgcGF0aCwgY2hhbmdlcyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogYWNxdWlyZSBjb2xsZWN0aW9uIGZvciBwYXRoXG4gICAgICogLSBhdXRvbWF0aWNhbGx5IHN1YnNjcmliZXMgdG8gcGF0aCBpZiBuZWVkZWRcbiAgICAgKi9cbiAgICBhY3F1aXJlX2NvbGxlY3Rpb24gKHBhdGgsIG9wdGlvbnMpIHtcbiAgICAgICAgcGF0aCA9IHBhdGguc3RhcnRzV2l0aChcIi9cIikgPyBwYXRoIDogXCIvXCIgKyBwYXRoO1xuICAgICAgICAvLyBzdWJzY3JpYmUgaWYgc3Vic2NyaXB0aW9uIGRvZXMgbm90IGV4aXN0c1xuICAgICAgICBpZiAoIXRoaXMuX3N1YnNfbWFwLmhhcyhwYXRoKSkge1xuICAgICAgICAgICAgLy8gc3Vic2NyaWJlIHRvIHBhdGhcbiAgICAgICAgICAgIHRoaXMuX3N1YihwYXRoKTtcbiAgICAgICAgfVxuICAgICAgICAvLyBjcmVhdGUgY29sbGVjdGlvbiBpZiBub3QgZXhpc3RzXG4gICAgICAgIGlmICghdGhpcy5fY29sbF9tYXAuaGFzKHBhdGgpKSB7XG4gICAgICAgICAgICB0aGlzLl9jb2xsX21hcC5zZXQocGF0aCwgbmV3IENvbGxlY3Rpb24odGhpcywgcGF0aCwgb3B0aW9ucykpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLl9jb2xsX21hcC5nZXQocGF0aCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogYWNxdWlyZSB2YXJpYWJsZSBmb3IgKHBhdGgsIG5hbWUpXG4gICAgICogLSBhdXRvbWF0aWNhbGx5IGFjcXVpcmUgY29sbGVjdGlvblxuICAgICAqL1xuICAgIGFjcXVpcmVfdmFyaWFibGUgKHBhdGgsIG5hbWUsIG9wdGlvbnMpIHtcbiAgICAgICAgcGF0aCA9IHBhdGguc3RhcnRzV2l0aChcIi9cIikgPyBwYXRoIDogXCIvXCIgKyBwYXRoO1xuICAgICAgICBjb25zdCBkcyA9IHRoaXMuYWNxdWlyZV9jb2xsZWN0aW9uKHBhdGgpO1xuICAgICAgICAvLyBjcmVhdGUgdmFyaWFibGUgaWYgbm90IGV4aXN0c1xuICAgICAgICBpZiAoIXRoaXMuX3Zhcl9tYXAuaGFzKHBhdGgpKSB7XG4gICAgICAgICAgICB0aGlzLl92YXJfbWFwLnNldChwYXRoLCBuZXcgTWFwKCkpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHZhcl9tYXAgPSB0aGlzLl92YXJfbWFwLmdldChwYXRoKTtcbiAgICAgICAgaWYgKCF2YXJfbWFwLmdldChuYW1lKSkge1xuICAgICAgICAgICAgdmFyX21hcC5zZXQobmFtZSwgbmV3IFZhcmlhYmxlKGRzLCBuYW1lLCBvcHRpb25zKSlcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdmFyX21hcC5nZXQobmFtZSlcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiByZWxlYXNlIHBhdGgsIGluY2x1ZGluZyBjb2xsZWN0aW9uIGFuZCB2YXJpYWJsZXNcbiAgICAgKi9cbiAgICByZWxlYXNlKHBhdGgpIHtcbiAgICAgICAgLy8gdW5zdWJzY3JpYmVcbiAgICAgICAgaWYgKHRoaXMuX3N1YnNfbWFwLmhhcyhwYXRoKSkge1xuICAgICAgICAgICAgdGhpcy5fdW5zdWIocGF0aCk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gdGVybWluYXRlIGNvbGxlY3Rpb24gYW5kIHZhcmlhYmxlc1xuICAgICAgICBjb25zdCBkcyA9IHRoaXMuX2NvbGxfbWFwLmdldChwYXRoKTtcbiAgICAgICAgZHMuX3NzY2xpZW50X3Rlcm1pbmF0ZSgpO1xuICAgICAgICBjb25zdCB2YXJfbWFwID0gdGhpcy5fdmFyX21hcC5nZXQocGF0aCk7XG4gICAgICAgIGlmICh2YXJfbWFwICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgZm9yIChjb25zdCB2IG9mIHZhcl9tYXAudmFsdWVzKCkpIHtcbiAgICAgICAgICAgICAgICB2Ll9zc2NsaWVudF90ZXJtaW5hdGUoKTtcbiAgICAgICAgICAgIH0gICAgXG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fY29sbF9tYXAuZGVsZXRlKHBhdGgpO1xuICAgICAgICB0aGlzLl92YXJfbWFwLmRlbGV0ZShwYXRoKTtcbiAgICB9XG59XG5cblxuIiwiLypcbiAgICBDb2xsZWN0aW9uIFZpZXdlclxuKi9cblxuZnVuY3Rpb24gaXRlbTJzdHJpbmcoaXRlbSkge1xuICAgIGNvbnN0IHtpZCwgaXR2LCBkYXRhfSA9IGl0ZW07XG4gICAgbGV0IGRhdGFfdHh0ID0gSlNPTi5zdHJpbmdpZnkoZGF0YSk7XG4gICAgbGV0IGl0dl90eHQgPSAoaXR2ICE9IHVuZGVmaW5lZCkgPyBKU09OLnN0cmluZ2lmeShpdHYpIDogXCJcIjtcbiAgICBsZXQgaWRfaHRtbCA9IGA8c3BhbiBjbGFzcz1cImlkXCI+JHtpZH08L3NwYW4+YDtcbiAgICBsZXQgaXR2X2h0bWwgPSBgPHNwYW4gY2xhc3M9XCJpdHZcIj4ke2l0dl90eHR9PC9zcGFuPmA7XG4gICAgbGV0IGRhdGFfaHRtbCA9IGA8c3BhbiBjbGFzcz1cImRhdGFcIj4ke2RhdGFfdHh0fTwvc3Bhbj5gO1xuICAgIHJldHVybiBgXG4gICAgICAgIDxkaXY+XG4gICAgICAgICAgICA8YnV0dG9uIGlkPVwiZGVsZXRlXCI+WDwvYnV0dG9uPlxuICAgICAgICAgICAgJHtpZF9odG1sfTogJHtpdHZfaHRtbH0gJHtkYXRhX2h0bWx9XG4gICAgICAgIDwvZGl2PmA7XG59XG5cblxuZXhwb3J0IGNsYXNzIENvbGxlY3Rpb25WaWV3ZXIge1xuXG4gICAgY29uc3RydWN0b3IoY29sbGVjdGlvbiwgZWxlbSwgb3B0aW9ucz17fSkge1xuICAgICAgICB0aGlzLl9jb2xsID0gY29sbGVjdGlvbjtcbiAgICAgICAgdGhpcy5fZWxlbSA9IGVsZW07XG4gICAgICAgIHRoaXMuX2hhbmRsZSA9IHRoaXMuX2NvbGwuYWRkX2NhbGxiYWNrKHRoaXMuX29uY2hhbmdlLmJpbmQodGhpcykpOyBcblxuICAgICAgICAvLyBvcHRpb25zXG4gICAgICAgIGxldCBkZWZhdWx0cyA9IHtcbiAgICAgICAgICAgIGRlbGV0ZTpmYWxzZSxcbiAgICAgICAgICAgIHRvU3RyaW5nOml0ZW0yc3RyaW5nXG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuX29wdGlvbnMgPSB7Li4uZGVmYXVsdHMsIC4uLm9wdGlvbnN9O1xuXG4gICAgICAgIC8qXG4gICAgICAgICAgICBTdXBwb3J0IGRlbGV0ZVxuICAgICAgICAqL1xuICAgICAgICBpZiAodGhpcy5fb3B0aW9ucy5kZWxldGUpIHtcbiAgICAgICAgICAgIC8vIGxpc3RlbiBmb3IgY2xpY2sgZXZlbnRzIG9uIHJvb3QgZWxlbWVudFxuICAgICAgICAgICAgZWxlbS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcbiAgICAgICAgICAgICAgICAvLyBjYXRjaCBjbGljayBldmVudCBmcm9tIGRlbGV0ZSBidXR0b25cbiAgICAgICAgICAgICAgICBjb25zdCBkZWxldGVCdG4gPSBlLnRhcmdldC5jbG9zZXN0KFwiI2RlbGV0ZVwiKTtcbiAgICAgICAgICAgICAgICBpZiAoZGVsZXRlQnRuKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGxpc3RJdGVtID0gZGVsZXRlQnRuLmNsb3Nlc3QoXCIubGlzdC1pdGVtXCIpO1xuICAgICAgICAgICAgICAgICAgICBpZiAobGlzdEl0ZW0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2NvbGwudXBkYXRlKHtyZW1vdmU6W2xpc3RJdGVtLmlkXX0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgLypcbiAgICAgICAgICAgIHJlbmRlciBpbml0aWFsIHN0YXRlXG4gICAgICAgICovIFxuICAgICAgICBjb25zdCBkaWZmcyA9IHRoaXMuX2NvbGwuZ2V0KClcbiAgICAgICAgICAgIC5tYXAoaXRlbSA9PiB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtpZDppdGVtLmlkLCBuZXc6aXRlbX1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB0aGlzLl9vbmNoYW5nZShkaWZmcyk7XG4gICAgfVxuXG4gICAgX29uY2hhbmdlKGRpZmZzKSB7XG4gICAgICAgIGNvbnN0IHt0b1N0cmluZ30gPSB0aGlzLl9vcHRpb25zO1xuICAgICAgICBmb3IgKGxldCBkaWZmIG9mIGRpZmZzKSB7XG4gICAgICAgICAgICBpZiAoZGlmZi5uZXcpIHtcbiAgICAgICAgICAgICAgICAvLyBhZGRcbiAgICAgICAgICAgICAgICBsZXQgbm9kZSA9IHRoaXMuX2VsZW0ucXVlcnlTZWxlY3RvcihgIyR7ZGlmZi5pZH1gKTtcbiAgICAgICAgICAgICAgICBpZiAobm9kZSA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIG5vZGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgICAgICAgICAgICAgICBub2RlLnNldEF0dHJpYnV0ZShcImlkXCIsIGRpZmYuaWQpO1xuICAgICAgICAgICAgICAgICAgICBub2RlLmNsYXNzTGlzdC5hZGQoXCJsaXN0LWl0ZW1cIik7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2VsZW0uYXBwZW5kQ2hpbGQobm9kZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIG5vZGUuaW5uZXJIVE1MID0gdG9TdHJpbmcoZGlmZi5uZXcpO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChkaWZmLm9sZCkge1xuICAgICAgICAgICAgICAgIC8vIHJlbW92ZVxuICAgICAgICAgICAgICAgIGxldCBub2RlID0gdGhpcy5fZWxlbS5xdWVyeVNlbGVjdG9yKGAjJHtkaWZmLmlkfWApO1xuICAgICAgICAgICAgICAgIGlmIChub2RlKSB7XG4gICAgICAgICAgICAgICAgICAgIG5vZGUucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChub2RlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59XG4iXSwibmFtZXMiOlsicmVzb2x2YWJsZVByb21pc2UiLCJyZXNvbHZlciIsIlByb21pc2UiLCJyZXNvbHZlIiwicmVqZWN0IiwiTUFYX1JFVFJJRVMiLCJXZWJTb2NrZXRJTyIsImNvbnN0cnVjdG9yIiwidXJsIiwib3B0aW9ucyIsInRoaXMiLCJfdXJsIiwiX3dzIiwiX2Nvbm5lY3RpbmciLCJfY29ubmVjdGVkIiwiX29wdGlvbnMiLCJfcmV0cmllcyIsIl9jb25uZWN0X3Byb21pc2VfcmVzb2x2ZXJzIiwiY29ubmVjdGluZyIsImNvbm5lY3RlZCIsImNvbm5lY3QiLCJjb25zb2xlIiwibG9nIiwiX2lzX3Rlcm1pbmF0ZWQiLCJXZWJTb2NrZXQiLCJvbm9wZW4iLCJlIiwiX29uX29wZW4iLCJvbm1lc3NhZ2UiLCJvbl9tZXNzYWdlIiwiZGF0YSIsIm9uY2xvc2UiLCJfb25fY2xvc2UiLCJvbmVycm9yIiwib25fZXJyb3IiLCJvbl9jb25uZWN0aW5nIiwiZXZlbnQiLCJvbl9jb25uZWN0Iiwib25fZGlzY29ubmVjdCIsInNldFRpbWVvdXQiLCJyZXRyaWVzIiwidW5kZWZpbmVkIiwiZGVidWciLCJlcnJvciIsInNlbmQiLCJjb25uZWN0ZWRQcm9taXNlIiwicHJvbWlzZSIsInB1c2giLCJDb2xsZWN0aW9uIiwic3NjbGllbnQiLCJwYXRoIiwiX3Rlcm1pbmF0ZWQiLCJfc3NjbGllbnQiLCJfcGF0aCIsIl9oYW5kbGVycyIsIl9tYXAiLCJNYXAiLCJfc3NjbGllbnRfdGVybWluYXRlIiwiX3NzY2xpZW50X3VwZGF0ZSIsImNoYW5nZXMiLCJFcnJvciIsInJlbW92ZSIsImluc2VydCIsInJlc2V0IiwiZGlmZl9tYXAiLCJpdGVtIiwidmFsdWVzIiwic2V0IiwiaWQiLCJuZXciLCJvbGQiLCJfaWQiLCJnZXQiLCJkZWxldGUiLCJkaWZmIiwiX25vdGlmeV9jYWxsYmFja3MiLCJlQXJnIiwiZm9yRWFjaCIsImhhbmRsZSIsImhhbmRsZXIiLCJzaXplIiwiaGFzIiwidXBkYXRlIiwibWFwIiwibGVuZ3RoIiwidGV4dCIsInBvc3NpYmxlIiwiaSIsImNoYXJBdCIsIk1hdGgiLCJmbG9vciIsInJhbmRvbSIsInJhbmRvbV9zdHJpbmciLCJhZGRfY2FsbGJhY2siLCJyZW1vdmVfY2FsbGJhY2siLCJpbmRleCIsImluZGV4T2YiLCJzcGxpY2UiLCJWYXJpYWJsZSIsImNvbGwiLCJfdGVybWluaWF0ZWQiLCJfY29sbCIsIl9oYW5kbGUiLCJfb25jaGFuZ2UiLCJiaW5kIiwiZGlmZnMiLCJub3RpZnlfY2FsbGJhY2tzIiwiX2hhbmRlcnMiLCJ2YWx1ZSIsIml0ZW1zIiwic3NfY2xpZW50X3Rlcm1pbmF0ZSIsImxvY2FsIiwicGVyZm9ybWFuY2UiLCJub3ciLCJlcG9jaCIsIkRhdGUiLCJDTE9DSyIsInQwX2xvY2FsIiwidDBfZXBvY2giLCJ0MV9sb2NhbCIsIlNlcnZlckNsb2NrIiwiX3BpbmdlciIsIlBpbmdlciIsIl9vbnBpbmciLCJfc2FtcGxlcyIsIl90cmFucyIsIl9za2V3IiwicmVzdW1lIiwicGF1c2UiLCJ0czAiLCJ0aGVuIiwib2siLCJ0czEiLCJfYWRkX3NhbXBsZSIsImNzIiwic3MiLCJjciIsInRyYW5zIiwic2tldyIsInNhbXBsZSIsInNoaWZ0IiwiREVMQVlfU0VRVUVOQ0UiLCJBcnJheSIsImZpbGwiLCJjYWxsYmFjayIsIl9jb3VudCIsIl90aWQiLCJfY2FsbGJhY2siLCJfcGluZyIsInBpbmciLCJfZGVsYXlzIiwiY2xlYXJUaW1lb3V0IiwicmVzdGFydCIsIm5leHRfZGVsYXkiLCJNc2dUeXBlIiwiT2JqZWN0IiwiZnJlZXplIiwiTUVTU0FHRSIsIlJFUVVFU1QiLCJSRVBMWSIsIk1zZ0NtZCIsIkdFVCIsIlBVVCIsIk5PVElGWSIsIml0ZW0yc3RyaW5nIiwiaXR2IiwiZGF0YV90eHQiLCJKU09OIiwic3RyaW5naWZ5IiwiY29sbGVjdGlvbiIsImVsZW0iLCJfZWxlbSIsImRlZmF1bHRzIiwidG9TdHJpbmciLCJhZGRFdmVudExpc3RlbmVyIiwiZGVsZXRlQnRuIiwidGFyZ2V0IiwiY2xvc2VzdCIsImxpc3RJdGVtIiwic3RvcFByb3BhZ2F0aW9uIiwibm9kZSIsInF1ZXJ5U2VsZWN0b3IiLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJzZXRBdHRyaWJ1dGUiLCJjbGFzc0xpc3QiLCJhZGQiLCJhcHBlbmRDaGlsZCIsImlubmVySFRNTCIsInBhcmVudE5vZGUiLCJyZW1vdmVDaGlsZCIsInN1cGVyIiwiX3JlcWlkIiwiX3BlbmRpbmciLCJfc3Vic19tYXAiLCJfY29sbF9tYXAiLCJfdmFyX21hcCIsIl9zZXJ2ZXJfY2xvY2siLCJlbnRyaWVzIiwibXNnIiwicGFyc2UiLCJ0eXBlIiwicmVxaWQiLCJ0dW5uZWwiLCJjbWQiLCJfaGFuZGxlX25vdGlmeSIsImRzIiwiX3JlcXVlc3QiLCJhcmciLCJfc3ViIiwiX3Vuc3ViIiwic3Vic19tYXAiLCJjbG9jayIsImFjcXVpcmVfY29sbGVjdGlvbiIsInN0YXJ0c1dpdGgiLCJhY3F1aXJlX3ZhcmlhYmxlIiwibmFtZSIsInZhcl9tYXAiLCJyZWxlYXNlIiwidiJdLCJtYXBwaW5ncyI6InlDQU1PLFNBQVNBLElBQ1osSUFBSUMsRUFJSixNQUFPLENBSE8sSUFBSUMsU0FBUSxDQUFDQyxFQUFTQyxLQUNoQ0gsRUFBV0UsQ0FBTyxJQUVMRixFQUNyQixDQ1ZBLE1BQU1JLEVBQWMsRUFFYixNQUFNQyxFQUVULFdBQUFDLENBQVlDLEVBQUtDLEVBQVEsSUFDckJDLEtBQUtDLEtBQU9ILEVBQ1pFLEtBQUtFLElBQ0xGLEtBQUtHLGFBQWMsRUFDbkJILEtBQUtJLFlBQWEsRUFDbEJKLEtBQUtLLFNBQVdOLEVBQ2hCQyxLQUFLTSxTQUFXLEVBQ2hCTixLQUFLTywyQkFBNkIsRUFDMUMsQ0FFSSxjQUFJQyxHQUFjLE9BQU9SLEtBQUtHLFdBQVksQ0FDMUMsYUFBSU0sR0FBYSxPQUFPVCxLQUFLSSxVQUFXLENBQ3hDLE9BQUlOLEdBQU8sT0FBT0UsS0FBS0MsSUFBSyxDQUM1QixXQUFJRixHQUFXLE9BQU9DLEtBQUtLLFFBQVMsQ0FFcEMsT0FBQUssR0FFUVYsS0FBS1EsWUFBY1IsS0FBS1MsVUFDeEJFLFFBQVFDLElBQUkseUNBR1paLEtBQUthLGlCQUNMRixRQUFRQyxJQUFJLGVBS2hCWixLQUFLRSxJQUFNLElBQUlZLFVBQVVkLEtBQUtDLE1BQzlCRCxLQUFLRyxhQUFjLEVBQ25CSCxLQUFLRSxJQUFJYSxPQUFTQyxHQUFLaEIs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
